{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/edition.html","webpack:///./src/templates/editionDialog.html","webpack:///./src/impl/ol/js/editionLayer.js","webpack:///./src/impl/ol/js/editionGeometryBase.js","webpack:///./src/impl/ol/js/editionSelectGeometry.js","webpack:///./src/facade/js/editionSelectGeometry.js","webpack:///./src/impl/ol/js/editioncontrol.js","webpack:///./src/impl/ol/js/editionHighlightGeometry.js","webpack:///./src/facade/js/editionHighlightGeometry.js","webpack:///./src/impl/ol/js/editionInsertGeometry.js","webpack:///./src/facade/js/editionInsertGeometry.js","webpack:///./src/impl/ol/js/editionModifyGeometry.js","webpack:///./src/facade/js/editionModifyGeometry.js","webpack:///./src/impl/ol/js/editionInsertTemporalGeometry.js","webpack:///./src/facade/js/editionInsertTemporalGeometry.js","webpack:///./src/impl/ol/js/editionSnapping.js","webpack:///./src/facade/js/editionSnapping.js","webpack:///./src/impl/ol/js/editionGeometryControl.js","webpack:///./src/facade/js/i18n/language.js","webpack:///./src/facade/js/editionDialog.js","webpack:///./src/facade/js/editionSpatialEngine.js","webpack:///./src/facade/js/editionGeometryControl.js","webpack:///./src/facade/js/editioncontrol.js","webpack:///./src/facade/js/edition.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","editionLayer","base","base_","map_","facadeMap_","ol3Layer_","isVisible_","isModified_","sandBoxFeatures_","sandBoxLayer_","selectedFeatures_","deletedFeatures_","geometry","undefined","type_","addTo","M","impl","Layer","this","layer","Vector","setZIndex","Map","Z_INDEX","type","WFS","addLayers","getImpl","getOL3Layer","setStyle","selectableStyle","getSandBoxStyle","style","Polygon","fill","color","opacity","stroke","width","setVisible","this_","highlightControl","highlightInteraction_","getFeatures","getArray","indexOf","highlightStyle","tipoGeometria","Point","radius","Mfeature","getOLFeature","idFeature","features","getSource","length","getId","ol","Collection","push","addFeatures","feature","getGeometry","getCoordinates","foundFeature","getFeatureById","gmlText","proj","Projection","code","axis","addEquivalentProjections","getProjection","format","GML3","readFeatures","olFeature","jsonFeature","GeoJSON","writeFeatureObject","newFeature","Feature","featureId","removeFeatures","MFeature","forEach","Array","apply","featuresArray","index","array","featureAlreadyAdded","Number","id","coordinates","unselectFeature","getSelectedStyle","splice","allFeatures","selectFeature","extent","createEmpty","f","extend","getExtent","featuresIdArray","attribute","foundFeatures","getOLFeatureByUniqueAttribute","Mfeatures","olFeatures","getMapImpl","getView","fit","duration","utils","getFeaturesExtent","setBbox","e","dialog","info","getOLFeaturesExtensionByAttribute","maxZoom","attr","MFeatures","getAttribute","clonedFeatures","clear","refresh","olMap","isNullOrEmpty","removeLayer","removeLayers","popup_","Style","Fill","Stroke","image","Circle","EditionGeometryBase","map","layer_","modifiedFeatures","interactions_","Control","element","callback","entityLayer","createInteraction","addInteraction","getControls","activated","deactivate","setActive","removeInteraction","removeControl","EditionSelectGeometry","selectInteraction_","interaction","Select","layers","multi","condition","events","click","on","EditionGeometryBaseImpl","isUndefined","EditionSelectGeometryImpl","exception","activate","obj","control","editionControl","html","getInteractions","DoubleClickZoom","dblClickInteraction_","evt","customEvt","CustomEvent","detail","coordinate","bubbles","getContainer","dispatchEvent","removeEventListener","EditionHighlightGeometry","pointerMove","EditionHighlightGeometryImpl","EditionInsertGeometry","drawInteraction_","layerType","getType","geometryType","getSimpleType","Draw","EditionInsertGeometryImpl","EditionModifyGeometry","modifyInteraction_","featuresCollection","getSelectedFeatureCollection","Modify","deleteCondition","event","shiftKeyOnly","singleClick","EditionModifyGeometryImpl","EditionTemporalGeometry","EditionTemporalGeometryImpl","EditionSnapping","snapInteraction_","Snap","source","getImplLayer","EditionSnappingImpl","EditionGeometryControl","geojson","requestParams","point","geom","srsName_","writeGetFeature","srsName","featurePrefix","featureTypes","outputFormat","maxFeatures","filter","intersects","geomField","bbox_","boundingExtent","MultiPoint","featureTmp","json","j","polygon","Math","floor","random","translations","en","es","getLang","res","language","getTranslation","lang","getValue","keyPath","translation","console","warn","split","reduce","prev","current","show","message","title","severity","acceptFn","cancelFn","template","compileSync","jsonp","vars","accept_btn","cancel_btn","addEvents","close","document","querySelector","removeChild","mapeaContainer","acceptButton","cancelButton","addEventListener","selectLayer","appendChild","getGeoJSONGeometry","jstsGeometry","jsts","io","GeoJSONWriter","write","unionFeature","feature1","feature2","getGeoJSON","setGeometry","unionGeometry","geom1","geom2","jstsGeom1","getJSTSGeometry","jstsGeom2","union","geometryIntersects","jsts_geom_intersects","targetFeatures","intersection","jsts_geom1","jsts_geom2","resultGeom","difference","jsts_geom_difference","GeoJSONReader","read","dividePolygon","splitFeature","selectedFeature","polygon2Divide","_geometries","line4Divide","getExteriorRing","polygonizer","operation","polygonize","Polygonizer","add","polygons","getPolygons","polygons2Create","newHole","size","geojsonRepresentation","polygon2Divide2Line","turf","polygonToLine","poligonos","lineToPolygon","dividePolygonWithHoles","exteriorRingTargetPoly","polygonizerTarget","getArea","getNumInteriorRing","isSimple","result","getPolygonsOnHoles","dividePolygonWithHolesJSTS","getNewHolePolygon","createDividedPolygons","polygonizerHole","iterator","hasNext","next","_holes","polygonizerHoles","poly1","poly2","holes","hole","polygonGeoJson","resultFeatures","cont","newPolygons","targetPolygonNoHoles","olNewTargetFeatureJSTS","newHoleFeatureJSTS","olNewTargetFeatureJSTSgj","newHoleFeatureJSTSgj","geomSelected","booleanContains","booleanOverlap","targetPolygonNoHolesJSTS","newHoleJSTS","EditionGeometryControlImpl","impl_","NAME","element_","entityLayer_","insertGeomControl","insertTemporalGeomControl","modifyGeomControl","translateGeomControl","selectGeomControl","snappingControl","entityAddWFSControl","insertPolygonButton","selectPolygonButton","selectPolygonByAreaButton","selectPolygonByLineButton","selectAllSandboxPolygonButton","modifyPolygonButton","dividePolygonButton","joinPolygonsButton","intersectPolygonButton","emptyPolygonButton","zoomToSelectedButton","addGeomButton","WFSManagerCtl","self_","snappingButton","activateSnapping","zoomMenuElement","zoomMenuPolygonButton","zoomMenuPolygonButtonClass","classList","manageSelectedClassInDropdown","showDropdownContent","hideDropdownContent","zoomDropdownMenu","zoomToSandBoxButton","zoomToSandBox","zoomToSelection","selectMenuElement","selectMenuPolygonButton","selectMenuPolygonButtonClass","selectDropdownMenu","removeFromSandBoxButton","removeSelectedFeaturesFromSandBox","selectPolygonByClick","selectPolygonByDraw","selectAllSandboxPolygon","deselectAllSandboxPolygonButton","deselectAllSandboxPolygon","insertPolygon","modifyPolygon","getElementsByTagName","confirmDialogJoinPolygons","addGeom","intersectPolygon","emptyPolygon","currentTarget","children","left","borderTopRightRadius","borderBottomRightRadius","marginBottom","selectedClass","nextElementSibling","deactiveControls","offsetParent","previousElementSibling","removeSelectedFeatures","unselectControls","removeFeaturesFromSandBox","className","replace","restoreDefaultClassDropdownButtons","onPolygonInserted","addNewFeatureToSandBox","onPolygonSelected","featureInSandBox","selected","getImplFeature","target","onPolygonSelectedByDraw","sandBoxFeatures","inter","getGeoJsonFromFeature","selectAllFeatures","unselectAllFeatures","featuresSelected","styles","getModifyStyle","onPolygonModified","getRevision","onPolygonDivided","body","cursor","resultPolygons","topologicalError","k","joinPolygons","targetPolygon","pairTargetPolygons","polygonsToDelete","polygonsToVerify","clone","jstsGeomFeature1","jstsGeomFeature2","equals","setId","addNewMFeatureToSandBox","onPolygonIntersected","getMFeatureById","args","doSpatialProcess","onGeometryEmptied","fnProcess","plantillaRecorte","createOLPolygonFeature","capasVectoriales","getLayers","addGeomFromVectorialLayer","layerName","layerVectorial","removeAllFeatures","setType","clon","wfsCatalog","getPanels","controls_","zoomToFeatures","preventDefault","mapContainer","getElementsByClassName","EditionSpinner","getServiceActive","featureRequest","getFeatureRequestBody","options","useProxy","XMLSerializer","serializeToString","proxy","remote","post","url","then","response","xml","documentElement","description","text","error","readGML3Features","un","getWfsFeatures","destroy","EditionImplControl","Promise","success","fail","import_btn","select_btn","select_click","select_line","select_area","select_all","deselect_all","zoom","zoom_sandbox","zoom_selection","geometry_draw","snapping","modify_polygon","geometry_divide","empty_polygon","delete_selected","createControls","geomControl","deactivateClick","Edition","position","metadata_","api","metadata","Plugin","control_","EditionControl","panel_","ui","Panel","addControls","addPanels","destroyControls","removeControls","plugin","window","M$plugin$Edition"],"mappings":"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","file":"edition.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = \"<div class=\\\"m-entitygeometry-container\\\">\\n    <div id=\\\"m-button-entitypolygon-vertical\\\" class=\\\"m-control button\\\">\\n        <!--<button id=\\\"m-addtosandbox-button\\\" class=\\\"g-cartografia-capas\\\" title=\\\"Añadir geometrías a la capa de trabajo\\\"></button> -->\\n        <button id=\\\"m-addgeometry-button\\\" class=\\\"icon-edition-import-button\\\" title=\\\"{{translations.import_btn}}\\\"></button>\\n        <div id=\\\"m-selectmenu-button\\\" class=\\\"dropdown-edition\\\">\\n            <button id=\\\"m-select-button\\\" class=\\\"g-cartografia-flecha\\\" title=\\\"{{translations.select_btn}}\\\"></button>\\n            <div id=\\\"myDropdown\\\" class=\\\"dropdown-edition-content\\\">\\n                <div><button id=\\\"m-selectclick-button\\\" class=\\\"icon-edition-select-click\\\" title=\\\"{{translations.select_click}}\\\"></button></div>\\n                <div><button id=\\\"m-selectline-button\\\" class=\\\"icon-edition-select-line\\\" title=\\\"{{translations.select_line}}\\\"></button></div>\\n                <div><button id=\\\"m-selectarea-button\\\" class=\\\"icon-edition-select-area\\\" title=\\\"{{translations.select_area}}\\\"></button></div>\\n                <div><button id=\\\"m-selectall-button\\\" class=\\\"icon-edition-select-all\\\" title=\\\"{{translations.select_all}}\\\"></button></div>\\n                <div><button id=\\\"m-deselectall-button\\\" class=\\\"icon-edition-deselect-all\\\" title=\\\"{{translations.deselect_all}}\\\"></button></div>\\n            </div>\\n        </div>\\n        <div id=\\\"m-zoommenu-button\\\" class=\\\"dropdown-edition\\\">\\n            <button id=\\\"m-zoom-button\\\" class=\\\"g-cartografia-zoom\\\" title=\\\"{{translations.zoom}}\\\"></button>\\n            <div id=\\\"myDropdown-edition\\\" class=\\\"dropdown-edition-content\\\">\\n                <div><button id=\\\"m-zoomsandbox-button\\\" class=\\\"icon-edition-zoom-sandbox\\\" title=\\\"{{translations.zoom_sandbox}}\\\"></button></div>\\n                <div><button id=\\\"m-zoomselect-button\\\" class=\\\"icon-edition-zoom-selection\\\" title=\\\"{{translations.zoom_selection}}\\\"></button></div>\\n            </div>\\n        </div>\\n        <button id=\\\"m-draw-button\\\" class=\\\"g-cartografia-editar\\\" title=\\\"{{translations.geometry_draw}}\\\"></button>\\n        <button id=\\\"m-snapping-button\\\" class=\\\"icon-edition-snapping\\\" title=\\\"{{translations.snapping}}\\\"></button>\\n        <button id=\\\"m-modify-button\\\" class=\\\"icon-edition-modify-polygon\\\" title=\\\"{{translations.modify_polygon}}\\\"></button>\\n        <button id=\\\"m-splitpolygon-button\\\" class=\\\"g-cartografia-linea\\\" title=\\\"{{translations.geometry_divide}}\\\"></button>\\n        <button id=\\\"m-unir-button\\\" class=\\\"icon-edition-union\\\" title=\\\"{{translations.union}}\\\"></button>\\n        <button id=\\\"m-vaciado-button\\\" class=\\\"icon-edition-empty-polygon\\\" title=\\\"{{translations.empty_polygon}}\\\"></button>\\n        <button id=\\\"m-intersect-button\\\" class=\\\"icon-edition-intersection\\\" title=\\\"{{translations.intersection}}\\\"></button>\\n        <button id=\\\"m-removefromsandbox-button\\\" class=\\\"icon-edition-delete-selected\\\" title=\\\"{{translations.delete_selected}}\\\"></button>\\n    </div>\\n</div>\";","module.exports = \"<div class=\\\"m-dialog {{severity}}\\\">\\n   <div class=\\\"m-modal\\\">\\n      <div class=\\\"m-content\\\">\\n         <div class=\\\"m-title\\\">\\n            <i class=\\\"m-icon\\\"></i>\\n            <span>{{{title}}}</span>\\n         </div>\\n         <div class=\\\"m-message\\\">{{{message}}}\\n            {{#if layers}}\\n            <br>\\n            <select class=\\\"m-layer-selection\\\">\\n               {{#each layers}}\\n               <option value=\\\"{{{this.name}}}\\\">{{this.name}}</option>\\n               {{/each}}\\n             </select> \\n             {{/if}}\\n         </div>\\n         <div id=\\\"m-edition-dialog-button-aceptar\\\" class=\\\"m-edition-dialog-button\\\">\\n            <button>{{translations.accept_btn}}</button>\\n         </div>\\n         <div id=\\\"m-edition-dialog-button-cancelar\\\" class=\\\"m-edition-dialog-button\\\">\\n            <button>{{translations.cancel_btn}}</button>\\n         </div>\\n      </div>\\n   </div>\\n</div>\";","// @namespace(\"M.impl\")\nexport default class editionLayer extends M.impl.Layer {\n\n  /**\n   * @classdesc\n   * Main constructor of the class. \n   *\n   * @constructor\n   * @extends {M.impl.Layer}\n   * @api stable\n   */\n  constructor(base) {\n\n    super();\n    /**\n     * Type of the layer\n     * @private\n     * @type {String}\n     */\n    this.base_ = base;\n    /**\n     * Type of the layer\n     * @private\n     * @type {String}\n     */\n    this.map_ = base.facadeMap_;\n    /**\n     * Type of the layer\n     * @private\n     * @type {String}\n     */\n    this.ol3Layer_ = null;\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.isVisible_ = true;\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.isModified_ = false;\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.sandBoxFeatures_ = [];\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.sandBoxLayer_ = null;\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.selectedFeatures_ = [];\n    /**\n     * Name of the layer\n     * @private\n     * @type {String}\n     */\n    this.deletedFeatures_ = [];\n    /**\n     * Facade of the map\n     * @private\n     * @type {M.Map}\n     */\n    this.geometry = undefined;\n\n    this.type_ = 'MultiPolygon';\n\n    this.addTo(this.map_);\n\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  addTo() {\n    this.sandBoxLayer_ = new M.layer.Vector();\n    this.sandBoxLayer_.name = 'editionLayer';\n    this.sandBoxLayer_.setZIndex(M.impl.Map.Z_INDEX[M.layer.type.WFS] + 999);\n    this.map_.addLayers(this.sandBoxLayer_);\n    this.ol3Layer_ = this.sandBoxLayer_.getImpl().getOL3Layer();\n    this.ol3Layer_.setStyle(this.selectableStyle(this.getSandBoxStyle()));\n    this.sandBoxLayer_.setStyle(new M.style.Polygon({\n      fill: {\n        color: 'red',\n        opacity: 0.5,\n      },\n      stroke: {\n        color: '#FF0000',\n        width: 2\n      }\n    }))\n    this.setVisible(true);\n  }\n\n\n  setStyle(style) {\n    this.sandBoxLayer_.setStyle(style);\n  }\n\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  selectableStyle(style) {\n    var this_ = this;\n    return function () {\n      if (this_.base_.highlightControl.getImpl().highlightInteraction_ === null) {\n        return style;\n      } else {\n        return this_.base_.highlightControl.getImpl().highlightInteraction_.getFeatures().getArray().indexOf(this) == -1 ? style : this_.base_.highlightControl.getImpl().highlightStyle;\n      }\n    };\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getType() {\n    // TODO: Poder especificar tipo de geometria de la capa en el plugin\n    return this.type_;\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  setType(tipoGeometria) {\n\n    this.type_ = tipoGeometria;\n\n    // Se adapta el estilo al tipo de geometria\n    if (tipoGeometria === 'MultiPoint' || tipoGeometria === 'Point') {\n      this.sandBoxLayer_.setStyle(new M.style.Point({\n        radius: 5,\n        fill: {\n          color: 'red',\n          opacity: 0.5\n        },\n        stroke: {\n          color: '#FF0000'\n        }\n      }));\n    } else if (tipoGeometria === 'MultiPolygon' || tipoGeometria === 'Polygon') {\n      this.sandBoxLayer_.setStyle(new M.style.Polygon({\n        fill: {\n          color: 'red',\n          opacity: 0.5,\n        },\n        stroke: {\n          color: '#FF0000',\n          width: 2\n        }\n      }));\n    } else if (tipoGeometria === 'MultiLineString' || tipoGeometria === 'LineString') {\n      // TODO: LINEAL\n    }\n  }\n\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getImplLayer() {\n    return this.ol3Layer_;\n  }\n\n  /**\n   * This function returns an olFeature when a Mapea feature is passed as a paremeter\n   *\n   * @public\n   * @function\n   * @param {Object} Mfeature\n   * @returns {Object} olFeature\n   * @api stable\n   */\n  getImplFeature(Mfeature) {\n    return Mfeature.getImpl().getOLFeature();\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getFeatureCollectionById(idFeature) {\n    var features = this.ol3Layer_.getSource().getFeatures();\n    for (let i = 0; i < features.length; i++) {\n      if (features[i].getId() === idFeature) {\n        return new ol.Collection([features[i]]);\n      }\n    }\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getFeatureCollection() {\n    var features = this.ol3Layer_.getSource().getFeatures();\n    return new ol.Collection([features]);\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  // DEVUELVE OL.\n  getSelectedFeatureCollection() {\n    var features = [];\n    for (let i = 0; i < this.selectedFeatures_.length; i++) {\n      features.push(this.selectedFeatures_[i].getImpl().getOLFeature());\n    }\n    return new ol.Collection(features);\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getOLFeatures() {\n    return this.ol3Layer_.getSource().getFeatures();\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getFeatures() {\n    return this.sandBoxLayer_.getFeatures();\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  addFeatures(features) {\n    return this.sandBoxLayer_.addFeatures(features);\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  hasGeometry() {\n    var features = this.ol3Layer_.getSource().getFeatures();\n    return features.length > 0;\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getGeometry() {\n    return this.geometry;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getCoordinatesFromFeature(feature) {\n    return feature.getGeometry().getCoordinates();\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getCoordinatesFromFeatureById(idFeature) {\n    const foundFeature = this.getFeatureById(idFeature);\n    if (foundFeature !== null) {\n      return foundFeature.getGeometry().getCoordinates();\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  readGML3Features(gmlText) {\n    var proj = new ol.proj.Projection({\n      code: 'http://www.opengis.net/gml/srs/epsg.xml#25830',\n      axis: 'enu'\n    });\n    ol.proj.addEquivalentProjections([ol.proj.get(this.map_.getProjection().code), proj]);\n    return new ol.format.GML3().readFeatures(gmlText, this.map_.getProjection());\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  addFeature(olFeature) {\n    var geojsonFormat = new ol.format.GeoJSON();\n    var jsonFeature = geojsonFormat.writeFeatureObject(olFeature);\n    var newFeature = new M.Feature(olFeature.getId(), jsonFeature);\n    this.sandBoxLayer_.addFeatures(newFeature);\n    return newFeature;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeFeatureById(featureId) {\n    var foundFeature = this.sandBoxLayer_.getFeatureById(featureId);\n    if (foundFeature !== undefined) {\n      this.sandBoxFeatures_ = [];\n      this.selectedFeatures_ = [];\n      this.sandBoxLayer_.removeFeatures([foundFeature]);\n      this.deletedFeatures_.push(foundFeature);\n      this.isModified_ = true;\n      return [foundFeature.getId()];\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeFeature(MFeature) {\n    var this_ = this;\n    this.sandBoxLayer_.getFeatures().forEach(function (feature) {\n      if (feature === MFeature) {\n        this_.sandBoxLayer_.removeFeatures([feature]);\n      }\n    });\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeAllFeatures() {\n    var features = this.sandBoxLayer_.getFeatures();\n    this.sandBoxLayer_.removeFeatures(features);\n    Array.prototype.push.apply(this.deletedFeatures_, features);\n    this.sandBoxFeatures_ = [];\n    this.selectedFeatures_ = [];\n    this.isModified_ = true;\n    return true;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  addFeaturesToSandBox(featuresArray) {\n    var this_ = this;\n    featuresArray.forEach(function (feature, index, array) {\n      var featureAlreadyAdded = false;\n      for (let i = 0; i < this_.sandBoxLayer_.getFeatures().length; i++) {\n        if (this_.sandBoxLayer_.getFeatures()[i].getImpl().getId() === Number(feature.id)) {\n          featureAlreadyAdded = true;\n          break;\n        }\n      }\n\n      if (!featureAlreadyAdded) {\n        var jsonFeature = {\n          \"type\": \"Feature\",\n          \"geometry\": {\n            \"type\": feature.type,\n            \"coordinates\": feature.coordinates\n          }\n        };\n\n        var newFeature = new M.Feature(feature.id, jsonFeature);\n        this_.sandBoxLayer_.addFeatures(newFeature);\n      }\n    });\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  addNewFeatureToSandBox(olFeature) {\n    var geojsonFormat = new ol.format.GeoJSON();\n    var jsonFeature = geojsonFormat.writeFeatureObject(olFeature);\n    var newFeature = new M.Feature(olFeature.getId(), jsonFeature);\n    this.sandBoxLayer_.addFeatures(newFeature);\n  }\n\n  addNewMFeatureToSandBox(feature) {\n    this.sandBoxLayer_.addFeatures(feature);\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeFeaturesFromSandBox(featuresArray) {\n    var i = featuresArray.length;\n    while (i--) {\n      var foundFeature = this.sandBoxLayer_.getFeatureById(featuresArray[i].getId());\n      if (foundFeature !== undefined) {\n        if (foundFeature instanceof M.Feature) {\n          this.unselectFeature(foundFeature.getImpl().getOLFeature());\n        } else {\n          this.unselectFeature(foundFeature);\n        }\n        this.sandBoxLayer_.removeFeatures(foundFeature);\n      }\n    }\n  }\n\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  selectFeature(olFeature) {\n    var foundFeature = this.sandBoxLayer_.getFeatureById(olFeature.getId());\n    if (foundFeature !== undefined) {\n      foundFeature.getImpl().getOLFeature().setStyle(this.selectableStyle(this.getSelectedStyle()));\n      this.selectedFeatures_.push(foundFeature);\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  unselectFeature(olFeature) {\n    var i = this.selectedFeatures_.length;\n    while (i--) {\n      if (this.selectedFeatures_[i].getImpl().getOLFeature().getId() === olFeature.getId()) {\n        this.selectedFeatures_[i].getImpl().getOLFeature().setStyle(this.selectableStyle(this.getSandBoxStyle()));\n        this.selectedFeatures_.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  selectAllFeatures() {\n    var allFeatures = this.sandBoxLayer_.getFeatures();\n    for (let i = 0; i < allFeatures.length; i++) {\n      if (this.selectedFeatures_.length > 0) {\n        var index = this.selectedFeatures_.indexOf(allFeatures[i]);\n        if (index === -1) {\n          this.selectFeature(allFeatures[i]);\n        }\n      } else {\n        this.selectFeature(allFeatures[i]);\n      }\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  unselectAllFeatures() {\n    var allFeatures = this.sandBoxLayer_.getFeatures();\n    for (let i = 0; i < allFeatures.length; i++) {\n      allFeatures[i].getImpl().getOLFeature().setStyle(this.selectableStyle(this.getSandBoxStyle()));\n    }\n    this.selectedFeatures_ = [];\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getGeometriesExtension() {\n    var features = this.ol3Layer_.getSource().getFeatures();\n    var extent = new ol.extent.createEmpty();\n    features.forEach(function (f, index, array) {\n      ol.extent.extend(extent, f.getGeometry().getExtent());\n    });\n\n    return extent;\n  }\n\n  /**\n   * Zooms the view to the features array\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getOLFeaturesExtensionByAttribute(featuresIdArray, attribute) {\n    var foundFeatures = [];\n    for (let i = 0; i < featuresIdArray.length; i++) {\n      var foundFeature = this.getOLFeatureByUniqueAttribute(Number(featuresIdArray[i]), attribute);\n      foundFeatures.push(foundFeature);\n    }\n\n    var extent = new ol.extent.createEmpty();\n    foundFeatures.forEach(function (f, index, array) {\n      if (f !== null) {\n        ol.extent.extend(extent, f.getGeometry().getExtent());\n      }\n    });\n\n    return extent;\n  }\n\n  /**\n   * Zooms the view to the features array\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getOLFeaturesExtension(Mfeatures) {\n    var olFeatures = [];\n    for (let i = 0; i < Mfeatures.length; i++) {\n      var olFeature = Mfeatures[i].getImpl().getOLFeature();\n      olFeatures.push(olFeature);\n    }\n\n    var extent = new ol.extent.createEmpty();\n    olFeatures.forEach(function (f, index, array) {\n      if (f !== null) {\n        ol.extent.extend(extent, f.getGeometry().getExtent());\n      }\n    });\n\n    return extent;\n  }\n\n\n  /**foundFeature\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  zoomToLayer() {\n    if (this.ol3Layer_.getSource().getFeatures().length > 0) {\n      var features = this.ol3Layer_.getSource().getFeatures();\n      var extent = new ol.extent.createEmpty();\n      features.forEach(function (f) {\n        ol.extent.extend(extent, f.getGeometry().getExtent());\n      });\n      this.map_.getMapImpl().getView().fit(extent, { duration: 500 });\n    }\n  }\n\n  /**\n   * Zooms the view to the features array\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  zoomToFeatures(Mfeatures) {\n    try {\n      let extent = M.impl.utils.getFeaturesExtent(Mfeatures);\n      this.map_.setBbox(extent);\n    } catch (e) {\n      M.dialog.info(\"No existe ninguna geometría asociada\");\n    }\n  }\n\n  /**\n   * Zooms the view to the features array\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  zoomToFeaturesByIdsArray(featuresIdArray, attribute) {\n    try {\n      var extent = this.getOLFeaturesExtensionByAttribute(featuresIdArray, attribute);\n      this.map_.getMapImpl().getView().fit(extent, { maxZoom: 12, duration: 500 });\n    } catch (e) {\n      M.dialog.info(\"No existe ninguna geometría asociada\");\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  zoomToFeatureById(featureId) {\n    var foundFeature = this.getFeatureById(featureId);\n    if (foundFeature !== null) {\n      var extent = new ol.extent.createEmpty();\n      ol.extent.extend(extent, foundFeature.getGeometry().getExtent());\n      this.map_.getMapImpl().getView().fit(extent, { maxZoom: 12, duration: 500 });\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getMFeatureByUniqueAttribute(value, attr) {\n    var MFeatures = this.sandBoxLayer_.getFeatures();\n    for (let i = 0; i < MFeatures.length; i++) {\n      if (MFeatures[i].getAttribute(attr) === value) {\n        return MFeatures[i];\n      }\n    }\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getFeatureById(featureId) {\n    let foundFeature = null;\n    if (this.ol3Layer_.getSource().getFeatures().length > 0) {\n      var features = this.ol3Layer_.getSource().getFeatures();\n      features.forEach(function (f, index, array) {\n        if (f.getId() === featureId) {\n          foundFeature = f;\n          return true;\n        }\n      });\n    }\n\n    return foundFeature;\n  }\n\n  getMFeatureById(featureId) {\n    let foundFeature = null;\n    foundFeature = this.sandBoxLayer_.getFeatureById(featureId);\n    return foundFeature;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getOLFeatureByUniqueAttribute(value, attr) {\n    let foundFeature = null;\n    if (this.ol3Layer_.getSource().getFeatures().length > 0) {\n      var features = this.ol3Layer_.getSource().getFeatures();\n      features.forEach(function (f, index, array) {\n        if (f.get(attr) === value) {\n          foundFeature = f;\n          return true;\n        }\n      });\n    }\n\n    return foundFeature;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getDeletedFeatures() {\n    return this.deletedFeatures_;\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clearDeletedFeaturesArray() {\n    this.deletedFeatures_ = [];\n  }\n\n  /**\n   * Zooms the view to the layer extent\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  rollbackFeatures(clonedFeatures) {\n    this.ol3Layer_.getSource().addFeatures(clonedFeatures);\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  clear() {\n    this.ol3Layer_.getSource().clear();\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  refresh() {\n    this.ol3Layer_.getSource().refresh();\n  }\n\n  /**\n   * This function destroys this layer, clearing the HTML\n   * and unregistering all events\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    var olMap = this.map_.getMapImpl();\n    if (!M.utils.isNullOrEmpty(this.ol3Layer_)) {\n      olMap.removeLayer(this.ol3Layer_);\n      this.ol3Layer_ = null;\n    }\n    this.map_.removeLayers(this.sandBoxLayer_);\n    this.map_ = null;\n    this.popup_ = null;\n    this.sandBoxFeatures_ = [];\n    this.name = null;\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getSandBoxStyle() {\n    return new ol.style.Style({\n      fill: new ol.style.Fill({\n        color: [93, 95, 229, 0.2]\n      }),\n      stroke: new ol.style.Stroke({\n        color: 'blue',\n        width: 2\n      }),\n      image: new ol.style.Circle({\n        radius: 4,\n        fill: new ol.style.Fill({\n          color: [93, 95, 229, 0.8]\n        }),\n        stroke: new ol.style.Stroke({\n          color: 'blue',\n          width: 2\n        })\n      })\n    });\n  }\n\n  /**\n   * This function sets the map object of the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map\n   * @api stable\n   */\n  getSelectedStyle() {\n    return new ol.style.Style({\n      fill: new ol.style.Fill({\n        color: [249, 232, 6, 0.1]\n      }),\n      stroke: new ol.style.Stroke({\n        color: 'yellow',\n        width: 2\n      }),\n      image: new ol.style.Circle({\n        radius: 4,\n        fill: new ol.style.Fill({\n          color: [249, 232, 6, 0.8]\n        }),\n        stroke: new ol.style.Stroke({\n          color: 'yellow',\n          width: 2\n        }),\n      })\n    });\n  }\n\n}\n","// @namespace(\"M.impl\")\nexport default class EditionGeometryBase extends M.impl.Control {\n  /**\n   * @classdesc\n   * Main constructor of the class.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n\n    super();\n    /**\n     * Layer for use in control\n     * @private\n     * @type {M.layer.WFS}\n     */\n    this.layer_ = layer;\n    /**\n     * Store modified features\n     * @public\n     * @type {array}\n     * @api stable\n     */\n    this.modifiedFeatures = [];\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    this.interactions_ = [];\n  }\n\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map - Map to add the plugin\n   * @param {HTMLElement} element - Container control\n   * @api stable\n   */\n  addTo(map, element) {\n    super.addTo(map, element);\n  }\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature, entityLayer) {\n    if (this.interactions_.length < 1) {\n      this.createInteraction(callback, idFeature, entityLayer);\n      for (let i = 0; i < this.interactions_.length; i++) {\n        this.layer_.map_.getMapImpl().addInteraction(this.interactions_[i]);\n      }\n    }\n\n    for (let i = 0; i < this.layer_.map_.getControls().length; i++) {\n      if (this.layer_.map_.getControls()[i].activated) {\n        this.layer_.map_.getControls()[i].deactivate();\n      }\n    }\n\n    for (let i = 0; i < this.interactions_.length; i++) {\n      this.interactions_[i].setActive(true);\n    }\n  }\n\n  /**\n   * This function deactivate control\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  deactivate() {\n    if (this.interactions_.length > 0) {\n      for (let i = 0; i < this.interactions_.length; i++) {\n        this.interactions_[i].setActive(false);\n        this.layer_.map_.getMapImpl().removeInteraction(this.interactions_[i]);\n      }\n      this.interactions_ = [];\n    }\n  }\n\n  /**\n   * This function destroys this control and cleaning the HTML\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.layer_.map_.getMapImpl().removeControl(this);\n    this.layer_ = null;\n    this.interactions_ = [];\n    this.modifiedFeatures = null;\n  }\n\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\n\nexport default class EditionSelectGeometry extends EditionGeometryBaseImpl {\n\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionSelectGeometry\n   *            control\n   * \n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction.Select}\n     */\n    this.selectInteraction_ = null;\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  createInteraction(callback, idFeature) {\n    this.selectInteraction_ = new ol.interaction.Select({\n      layers: [this.layer_.sandBoxLayer_.getImpl().getOL3Layer()],\n      multi: true,\n      condition: ol.events.condition.click\n    });\n\n    this.selectInteraction_.on('select', callback, this);\n    this.interactions_.push(this.selectInteraction_);\n  }\n}\n","import EditionSelectGeometryImpl from 'impl/editionSelectGeometry';\n\n// @namespace(\"M.control\")\nexport default class EditionSelectGeometry extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionSelectGeometry\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionSelectGeometryImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionSelectGeometry');\n    }\n\n    // 2. implementation of this control\n    let impl = new EditionSelectGeometryImpl(map, layer);\n    super(impl, \"editionSelectGeometry\");\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    this.name = 'editionSelectGeometry';\n\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature) {\n    this.getImpl().activate(callback, idFeature);\n    this.activated = true;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    return (obj instanceof M.control.EditionSelectGeometry);\n  }\n\n  /**\n   * This function set layer for draw\n   *\n   * @public\n   * @function\n   * @param {object} layer - Layer\n   * @api stable\n   */\n  setLayer(layer) {\n    this.getImpl().layer_ = layer;\n  }\n}\n","// @namespace(\"M.impl.control\")\nexport default class editionControl extends M.impl.Control {\n  /**\n   * @classdesc\n   * Main constructor of the editionControl.\n   *\n   * @constructor\n   * @extends {M.impl.Control}\n   * @api stable\n   */\n  constructor() {\n    super();\n  }\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the plugin\n   * @param {HTMLElement} html of the plugin\n   * @api stable\n   */\n  addTo(map, html) {\n    //obtengo la interacción por defecto del dblclick para manejarla\n    let olMap = map.getMapImpl();\n    olMap.getInteractions().forEach(interaction => {\n      if (interaction instanceof ol.interaction.DoubleClickZoom) {\n        this.dblClickInteraction_ = interaction;\n      }\n    });\n\n    // super addTo - don't delete\n    super.addTo(map, html);\n  }\n\n  //** Add your own functions */\n  activateClick(map) {\n    //desactivo el zoom al dobleclick\n    this.dblClickInteraction_.setActive(false);\n\n    //añado un listener al evento dblclick\n    let olMap = map.getMapImpl();\n    olMap.on('dblclick', function(evt) {\n      //disparo un custom event con las coordenadas del dobleclick\n      let customEvt = new CustomEvent('mapclicked', {\n        detail: evt.coordinate,\n        bubbles: true\n      });\n      map.getContainer().dispatchEvent(customEvt);\n    });\n  }\n\n  deactivateClick(map) {\n    //activo el zoom al dobleclick\n    this.dblClickInteraction_.setActive(true);\n\n    //elimino el listener del evento\n    map.getMapImpl().removeEventListener('dblclick');\n  }\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\nexport default class EditionHighlightGeometry extends EditionGeometryBaseImpl {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionHighlightGeometry\n   *            control\n   * \n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction.Select}\n     */\n    this.highlightInteraction_ = null;\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  createInteraction(callback, idFeature) {\n    var this_ = this;\n    // el estilo debe depender del tipo de geometria\n    this.highlightStyle = [\n      new ol.style.Style({\n        fill: new ol.style.Fill({\n          color: [249, 177, 10, 0.2]\n        })\n      }),\n      new ol.style.Style({\n        stroke: new ol.style.Stroke({\n          color: 'orange',\n          width: 2.5\n        })\n      })\n    ];\n\n    this.highlightInteraction_ = new ol.interaction.Select({\n      layers: [this.layer_.sandBoxLayer_.getImpl().getOL3Layer()],\n      condition: ol.events.condition.pointerMove,\n      style: this_.highlightStyle\n    });\n\n    this.interactions_.push(this.highlightInteraction_);\n  }\n}\n","import EditionHighlightGeometryImpl from 'impl/editionHighlightGeometry';\n\n// @namespace(\"M.control\")\nexport default class EditionHighlightGeometry extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionHighlightGeometry\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionHighlightGeometryImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionHighlightGeometry');\n    }\n\n    let impl = new EditionHighlightGeometryImpl(map, layer);\n    super(impl, \"editionHighlightGeometry\");\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    this.name = 'editionHighlightGeometry';\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature) {\n    this.getImpl().activate(callback, idFeature);\n    this.activated = true;\n  }\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  deactivate() {\n    this.getImpl().deactivate();\n    this.getImpl().highlightInteraction_ = null;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    return (obj instanceof M.control.EditionHighlightGeometry);\n  }\n\n  /**\n   * This function set layer for draw\n   *\n   * @public\n   * @function\n   * @param {object} layer - Layer\n   * @api stable\n   */\n  setLayer(layer) {\n    this.getImpl().layer_ = layer;\n  }\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\nexport default class EditionInsertGeometry extends EditionGeometryBaseImpl {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a EditionInsertGeometry\n   * control\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction}\n     */\n    this.drawInteraction_ = null;\n  }\n\n  /**\n   * This function creates the interaction to draw\n   *\n   * @private\n   * @function\n   * @param {object} callback - Callback function in activation\n   * @api stable\n   */\n  createInteraction(callback, idFeature, entityLayer) {\n\n    var style = null;\n\n    var layerType = this.layer_.getType();\n\n    if (entityLayer !== null && entityLayer !== undefined) {\n      layerType = entityLayer.getType();\n    }\n\n    var geometryType = this.getSimpleType(layerType);\n    // el estilo cambia segun tipo de geometria\n    if (layerType == 'Point') {\n      style = new ol.style.Style({\n        image: new ol.style.Circle({\n          radius: 7,\n          fill: new ol.style.Fill({ color: 'withe' }),\n          stroke: new ol.style.Stroke({\n            color: [255, 0, 0],\n            width: 2\n          })\n        })\n      });\n\n    } else if (layerType == 'Polygon') {\n      style = new ol.style.Style({\n        fill: new ol.style.Fill({\n          color: 'rgba(255, 255, 255, 0.2)'\n        }),\n        stroke: new ol.style.Stroke({\n          color: '#ffcc33',\n          width: 2\n        }),\n        image: new ol.style.Circle({\n          radius: 4,\n          fill: new ol.style.Fill({\n            color: '#ffcc33'\n          })\n        })\n      });\n\n    } else {\n      // TODO: LINE\n    }\n\n    this.drawInteraction_ = new ol.interaction.Draw({\n      type: geometryType,\n      style: style,\n    });\n\n    this.drawInteraction_.on('drawend', callback, this);\n\n    this.interactions_.push(this.drawInteraction_);\n  }\n\n  /**\n   * This function gets the simple type geometry from a complex geometry type\n   *\n   * @private\n   * @param {String} type - Geometry type\n   * @function\n   * @api stable\n   */\n  getSimpleType(type) {\n    if (type === 'MultiPoint' || type === 'Point') {\n      return 'Point';\n    } else if (type === 'MultiPolygon' || type === 'Polygon') {\n      return 'Polygon';\n    } else if (type === 'MultiLineString' || type === 'LineString') {\n      return 'LineString';\n    }\n  }\n}\n","import EditionInsertGeometryImpl from 'impl/editionInsertGeometry';\n\n// @namespace(\"M.control\")\nexport default class EditionInsertGeometry extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionInsertGeometry\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionInsertGeometryImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionInsertGeometry');\n    }\n\n    let impl = new EditionInsertGeometryImpl(map, layer);\n    super(impl, \"editionInsertGeometry\");\n\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    this.name = 'editionInsertGeometry';\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature, entityLayer) {\n    this.getImpl().activate(callback, idFeature, entityLayer);\n    this.activated = true;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    return (obj instanceof M.control.EditionInsertGeometry);\n  }\n\n  /**\n   * This function set layer for draw\n   *\n   * @public\n   * @function\n   * @param {object} layer - Layer\n   * @api stable\n   */\n  setLayer(layer) {\n    this.getImpl().layer_ = layer;\n  }\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\nexport default class EditionModifyGeometry extends EditionGeometryBaseImpl {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a EditionModifyGeometry\n   * control\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction.Modify}\n     */\n    this.modifyInteraction_ = null;\n\n  }\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  createInteraction(callback, idFeature) {\n    var featuresCollection = this.layer_.getSelectedFeatureCollection();\n    // Son features OL\n    var style = new ol.style.Style({\n      image: new ol.style.Circle({\n        radius: 4,\n        fill: new ol.style.Fill({\n          color: '#ffcc33'\n        })\n      })\n    });\n\n    this.modifyInteraction_ = new ol.interaction.Modify({\n      features: featuresCollection,\n      deleteCondition: function(event) {\n        return ol.events.condition.shiftKeyOnly(event) && ol.events.condition.singleClick(event);\n      },\n      style: style\n    });\n\n    this.modifyInteraction_.on('modifyend', callback, this);\n    this.interactions_.push(this.modifyInteraction_);\n  }\n}\n","import EditionModifyGeometryImpl from 'impl/editionModifyGeometry';\n\n// @namespace(\"M.control\")\nexport default class EditionModifyGeometry extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionModifyGeometry\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionModifyGeometryImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionModifyGeometry');\n    }\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    let impl = new EditionModifyGeometryImpl(map, layer);\n    super(impl, \"editionModifyGeometry\");\n\n    this.name = 'editionModifyGeometry';\n  }\n\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature) {\n    this.getImpl().activate(callback, idFeature);\n    this.activated = true;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    return (obj instanceof M.control.EditionModifyGeometry);\n  }\n\n  /**\n   * This function set layer for draw\n   *\n   * @public\n   * @function\n   * @param {object} layer - Layer\n   * @api stable\n   */\n  setLayer(layer) {\n    this.getImpl().layer_ = layer;\n  }\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\nexport default class EditionTemporalGeometry extends EditionGeometryBaseImpl {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a EditionTemporalGeometry\n   * control\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction}\n     */\n    this.drawInteraction_ = null;\n\n  }\n\n  /**\n   * This function creates the interaction to draw\n   *\n   * @private\n   * @function\n   * @param {object} callback - Callback function in activation\n   * @api stable\n   */\n  createInteraction(callback, geometryType) {\n    var style = new ol.style.Style({\n      fill: new ol.style.Fill({\n        color: 'rgba(255, 255, 255, 0.2)'\n      }),\n      stroke: new ol.style.Stroke({\n        color: '#ffa733',\n        width: 2\n      }),\n      image: new ol.style.Circle({\n        radius: 4,\n        fill: new ol.style.Fill({\n          color: '#ffcc33'\n        })\n      })\n    });\n\n    this.drawInteraction_ = new ol.interaction.Draw({\n      type: geometryType === 'Point' ? 'Point' : geometryType === 'LineString' ? 'LineString' : 'Polygon',\n      style: style,\n    });\n\n    this.drawInteraction_.on('drawend', callback, this);\n    this.interactions_.push(this.drawInteraction_);\n  }\n}\n","import EditionTemporalGeometryImpl from 'impl/editionInsertTemporalGeometry';\n\n// @namespace(\"M.control\")\nexport default class EditionTemporalGeometry extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionTemporalGeometry\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionTemporalGeometryImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionInsertLine');\n    }\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    let impl = new EditionTemporalGeometryImpl(map, layer);\n    super(impl, \"editionInsertLine\");\n\n    this.name = 'editionInsertLine';\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature, layer) {\n    this.getImpl().activate(callback, idFeature, layer);\n    this.activated = true;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    return (obj instanceof M.control.EditionTemporalGeometry);\n  }\n}\n","import EditionGeometryBaseImpl from 'impl/editionGeometryBase';\n\n// @namespace(\"M.impl.control\")\nexport default class EditionSnapping extends EditionGeometryBaseImpl {\n\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a EditionSnapping\n   * control\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    super(map, layer);\n    /**\n     * Facade map object\n     * @public\n     * @type {M.Map}\n     */\n    this.map_ = map;\n    /**\n     * OpenLayers interaction object\n     * @public\n     * @type {ol.interaction}\n     */\n    this.snapInteraction_ = null;\n  }\n\n  /**\n   * This function creates the interaction to draw\n   *\n   * @private\n   * @function\n   * @param {object} callback - Callback function in activation\n   * @api stable\n   */\n  createInteraction(callback, idFeature) {\n    this.snapInteraction_ = new ol.interaction.Snap({\n      source: this.layer_.getImplLayer().getSource()\n    });\n\n    this.interactions_.push(this.snapInteraction_);\n  }\n}\n","import EditionSnappingImpl from 'impl/editionSnapping';\n\n// @namespace(\"M.control\")\nexport default class EditionSnapping extends M.Control {\n  /**\n   * @classdesc Main constructor of the class. Creates a EditionSnapping\n   * control to draw features on the map.\n   *\n   * @constructor\n   * @param {M.Map} map - Facade map\n   * @param {object} layer - Layer for use in control\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(map, layer) {\n    if (M.utils.isUndefined(EditionSnappingImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionSnapping');\n    }\n    let impl = new EditionSnappingImpl(map, layer);\n    super(impl, \"editionSnapping\");\n\n    /**\n     * Name of the control\n     * @public\n     * @type {String}\n     */\n    this.name = 'editionSnapping';\n  }\n\n\n  /**\n   * This function activates this interaction control\n   *\n   * @function\n   * @api stable\n   * @param {object} callback - Callback function in activation\n   * @param {object} idFeature\n   */\n  activate(callback, idFeature) {\n    this.getImpl().activate(callback, idFeature);\n    this.activated = true;\n  }\n\n  /**\n   * This function checks if an object is equals to this control\n   *\n   * @function\n   * @api stable\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   */\n  equals(obj) {\n    //return (obj instanceof M.control.EditorInsertGeometry);\n    // era un bug?\n    return (obj instanceof M.control.EditionSnapping);\n  }\n\n  /**\n   * This function set layer for draw\n   *\n   * @public\n   * @function\n   * @param {object} layer - Layer\n   * @api stable\n   */\n  setLayer(layer) {\n    this.getImpl().layer_ = layer;\n  }\n}\n","// @namespace(\"M.impl.control\")\nexport default class EditionGeometryControl extends M.impl.Control {\n  /**\n   * @classdesc\n   * Main constructor of the EditionGeometryControl.\n   *\n   * @constructor\n   * @extends {M.impl.Control}\n   * @api stable\n   */\n  constructor(map) {\n    super();\n    this.map = map;\n  }\n\n\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the plugin\n   * @param {HTMLElement} html of the plugin\n   * @api stable\n   */\n  addTo(map, html) {\n    // super addTo\n    super.addTo(map, html);\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  getFeaturesFromGeoJson(geojson) {\n    var geojsonFormat = new ol.format.GeoJSON();\n    return geojsonFormat.readFeatures(geojson);\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  getGeoJsonFromFeature(feature) {\n    var geojsonFormat = new ol.format.GeoJSON();\n    return geojsonFormat.writeFeatureObject(feature);\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  getFeatureRequestBody(requestParams, coordinates) {\n    var point = new ol.geom.Point(coordinates);\n    var srsName_ = this.map.getProjection().code;\n    return new ol.format.WFS().writeGetFeature({\n      srsName: srsName_,\n      featurePrefix: requestParams.featurePrefix,\n      featureTypes: requestParams.featureTypes,\n      outputFormat: requestParams.outputFormat,\n      maxFeatures: requestParams.maxFeatures,\n      filter: ol.format.filter.intersects(requestParams.geomField, point, srsName_)\n    });\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  getBbox(coordinates) {\n    var bbox_ = ol.extent.boundingExtent([coordinates, coordinates]);\n    for (let i = 0; i < bbox_.length; i++) {\n      if (i == 2 || i == 3) {\n        bbox_[i] = bbox_[i] + 0.0000000001;\n      }\n    }\n\n    return bbox_;\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  getModifyStyle(olFeature) {\n    return [\n      new ol.style.Style({\n        fill: new ol.style.Fill({\n          color: 'rgba(239,245,3,0.25)'\n        }),\n        stroke: new ol.style.Stroke({\n          width: 3,\n          color: 'rgba(239,245,3, 0.8)'\n        }),\n        image: new ol.style.Circle({\n          radius: 4,\n          fill: new ol.style.Fill({\n            color: 'rgba(239,245,3,0.8)'\n          }),\n          stroke: new ol.style.Stroke({\n            color: 'rgba(239,245,3, 1)',\n            width: 2\n          })\n        })\n      }),\n      new ol.style.Style({\n        image: new ol.style.Circle({\n          radius: 6,\n          fill: new ol.style.Fill({\n            color: 'rgba(230,137,16, 0.8)'\n          })\n        }),\n        geometry: function (feature) {\n          // return the coordinates of the first ring of the polygon\n          var coordinates = olFeature.getGeometry().getCoordinates();\n          if (olFeature.getGeometry().getType() === \"MultiPolygon\") {\n            coordinates = olFeature.getGeometry().getCoordinates()[0][0];\n          } \n          return new ol.geom.MultiPoint(coordinates);\n        }\n      })\n    ];\n  }\n\n  /**\n   * This function set layer for modify features\n   *\n   * @public\n   * @function\n   * @param {M.layer.WFS} layer - Layer\n   * @api stable\n   */\n  createOLPolygonFeature(olFeature) {\n    var json = olFeature.getGeometry();\n    var featureTmp;\n\n    for (let j = 0; j < json.coordinates.length; j++) {\n      var polygon = json.coordinates[j];\n      featureTmp = new M.Feature(Math.floor(Math.random() * 1000000), {\n        \"type\": \"Polygon\",\n        \"geometry\": polygon,\n        \"geometry_name\": \"geometry\",\n        \"properties\": {}\n      });\n    }\n\n    return featureTmp;\n  }\n}\n","import en from './en';\nimport es from './es';\n\n/**\n * Default object with es and en translate.\n *\n * @const\n * @type {object}\n */\nconst translations = {\n  en,\n  es,\n};\n\nconst getLang = () => {\n  let res = 'es';\n  if (typeof M.language.getLang === 'function') {\n    res = M.language.getLang();\n  }\n\n  return res;\n};\n\n/**\n * This function sets a new language translate.\n * @param {string} lang\n * @param {JSON} json\n * @public\n * @api\n */\nexport const addTranslation = (lang, json) => {\n  translations[lang] = json;\n};\n\n/**\n * This function gets a language translate.\n *\n * @param {string} lang\n * @return {JSON}\n * @public\n * @api\n */\nexport const getTranslation = (lang) => {\n  return translations[lang];\n};\n\n/**\n * This function gets a language value from key\n *\n * @public\n * @param {string}\n * @param {string}\n * @return {string}\n * @public\n * @api\n */\n\nexport const getValue = (keyPath, lang = getLang()) => {\n  const translation = getTranslation(lang);\n  let value = '';\n  if (M.utils.isNullOrEmpty(translation)) {\n    /* eslint-disable no-console */\n    console.warn(`The translation '${lang}' has not been defined.`);\n  } else {\n    value = keyPath.split('.').reduce((prev, current) => prev[current], translation);\n  }\n\n  return value;\n};\n","import template from 'templates/editionDialog';\nimport { getValue } from './i18n/language';\n\n/**\n * This function shows the edition dialog\n *\n * @public\n * @function\n * @api stable\n * @param {string} Dialog message\n * @param {string} Dialog title\n * @param {object} Message severity\n * @param {object} Accept callback function\n * @param {object} Cancel callback function\n * @returns {Promise}\n */\nexport const show = (message, title, severity, acceptFn, cancelFn, layers) => {\n  const html = M.template.compileSync(template, {\n    jsonp: false,\n    vars: {\n      'message': message,\n      'title': title,\n      'severity': severity,\n      'layers': layers,\n      translations: {\n        accept_btn: getValue('accept_btn'),\n        cancel_btn: getValue('cancel_btn')\n      }\n    }\n  });\n  addEvents(html, acceptFn, cancelFn);\n};\n\n/**\n * This function closes the edition dialog\n * \n * @public\n * @function\n * @api stable\n */\nexport const close = () => {\n  var element = document.querySelector('div.m-dialog');\n  document.querySelector('div.m-mapea-container').removeChild(element);\n};\n\n/**\n * This function add the events to the specified html element\n *\n * @private\n * @function\n * @param {HTMLElement} html template\n * @param {object} Accept callback function\n * @param {object} Cancel callback function\n * @api stable\n */\nexport const addEvents = (html, acceptFn, cancelFn) => {\n  // append new dialog\n  var mapeaContainer = document.querySelector('div.m-mapea-container');\n\n  // adds listener to accept button click\n  var acceptButton = html.querySelector('#m-edition-dialog-button-aceptar > button');\n\n  // adds listener to cancel button click\n  var cancelButton = html.querySelector('#m-edition-dialog-button-cancelar > button');\n  if (cancelFn === undefined) {\n    cancelButton.addEventListener('click', close, false);\n  } else {\n    cancelButton.addEventListener('click', cancelFn, false);\n  }\n\n  var selectLayer = html.querySelector('.m-layer-selection');\n  if (selectLayer) {\n    acceptButton.addEventListener('click', function () { acceptFn(selectLayer.value) }, false);\n  } else {\n    acceptButton.addEventListener('click', acceptFn, false);\n  }\n\n  mapeaContainer.appendChild(html);\n};\n","/*jshint undef:false */\n/**\n *\n * @function\n * @api\n */\nexport const bufferFeature = (feature, distance) => {\n  feature.setGeometry(bufferGeometry(feature.getGeoJSON().geometry, distance));\n  return feature;\n};\n\n/**\n * Buffer sobre geometry geoJSON, devuelve geoJSON\n *\n * @public\n * @function\n * @api stable\n */\nexport const bufferGeometry = (geometry, distance) => {\n  let jstsGeom = getJSTSGeometry(geometry);\n  let bufferGeometry = jstsGeom.buffer(distance);\n  let finalGeometry = getGeoJSONGeometry(bufferGeometry);\n  return finalGeometry;\n};\n\n/**\n * @public\n * @function\n * @param {*} jstsGeometry \n */\nexport const getGeoJSONGeometry = (jstsGeometry) => {\n  let writter = new jsts.io.GeoJSONWriter();\n  let geojsonGeometry = writter.write(jstsGeometry);\n  return geojsonGeometry;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const unionFeature = (feature1, feature2) => {\n  // Clonamos el feature1\n  let newFeature = new M.Feature(feature1.getId(), feature1.getGeoJSON());\n  newFeature.setGeometry(unionGeometry(feature1.getGeometry(), feature2.getGeometry()));\n  return newFeature;\n\n};\n\nexport const unionGeometry = (geom1, geom2) => {\n  let jstsGeom1 = getJSTSGeometry(geom1);\n  let jstsGeom2 = getJSTSGeometry(geom2);\n  let unionGeometry = jstsGeom1.union(jstsGeom2);\n\n  return getGeoJSONGeometry(unionGeometry);\n};\n\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const splitFeature = (feature, geometryLine) => {\n  let jsts_geom = getJSTSGeometry(feature.getGeometry());\n\n  if (jsts_geom._geometries !== undefined) {\n    jsts_geom = jsts_geom._geometries[0];\n  }\n\n  let jsts_geom_line = getJSTSGeometry(geometryLine);\n  let union = jsts_geom.getExteriorRing().union(jsts_geom_line);\n\n  let polygonizer = getPolygonizer();\n  polygonizer.add(union);\n  let polygons = polygonizer.getPolygons();\n  let resultFeatures = [];\n\n  for (var i = polygons.iterator(); i.hasNext();) {\n\n    var polygon = i.next();\n    let newFeature = new M.Feature(Math.random(), feature.getGeoJSON());\n    let totalHoles = jsts_geom.getNumInteriorRing();\n\n    for (var n = 0; n < totalHoles; n++) {\n      let hole = jsts_geom.getInteriorRingN(n);\n      let holePolygonizer = getPolygonizer();\n      holePolygonizer.add(hole);\n      let holePolygons = holePolygonizer.getPolygons();\n\n      polygon = polygon.difference(holePolygons.iterator().next());\n    }\n    let impl_geom = getGeoJSONGeometry(polygon);\n    newFeature.setGeometry(impl_geom);\n    resultFeatures.push(newFeature);\n  }\n  return resultFeatures;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const intersects = (features, geometryIntersects) => {\n  let jsts_geom_intersects = getJSTSGeometry(geometryIntersects);\n  let targetFeatures = [];\n\n  features.forEach(function (feature) {\n    var jsts_geom = getJSTSGeometry(feature.getGeometry());\n\n    if (jsts_geom.intersects(jsts_geom_intersects)) {\n      targetFeatures.push(feature);\n    }\n\n  });\n  return targetFeatures;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const intersection = (feature1, feature2) => {\n  let jsts_geom1 = getJSTSGeometry(feature1.getGeometry());\n  let jsts_geom2 = getJSTSGeometry(feature2.getGeometry());\n  let resultGeom = jsts_geom1.intersection(jsts_geom2);\n\n  let intersectionGeom = getGeoJSONGeometry(resultGeom);\n  return intersectionGeom;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const difference = (feature, feature2) => {\n  var jsts_geom_difference = getJSTSGeometry(feature2.getGeometry());\n  var jsts_geom = getJSTSGeometry(feature.getGeometry());\n  var resultGeom = jsts_geom.difference(jsts_geom_difference);\n\n  var impl_geom = getGeoJSONGeometry(resultGeom);\n  return impl_geom;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const getJSTSGeometry = (geometry) => {\n  let parser = new jsts.io.GeoJSONReader();\n  let f = parser.read(geometry);\n  return f;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const getPolygonizer = () => {\n  return new jsts.operation.polygonize.Polygonizer();\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const dividePolygon = (splitFeature, selectedFeature) => {\n  let polygon2Divide = getJSTSGeometry(selectedFeature.getGeometry());\n  if (polygon2Divide._geometries !== undefined) {\n    polygon2Divide = polygon2Divide._geometries[0];\n  }\n\n  let line4Divide = getJSTSGeometry(splitFeature.getGeometry());\n\n  try {\n    let union = polygon2Divide.getExteriorRing().union(line4Divide);\n\n    let polygonizer = new jsts.operation.polygonize.Polygonizer();\n    polygonizer.add(union);\n    let polygons = polygonizer.getPolygons();\n    let polygons2Create = polygons;\n    let newHole = null;\n\n    if (polygons.size() < 2) {\n      try {\n        let geojsonRepresentation = selectedFeature.getGeometry();\n        // eslint-disable-next-line no-undef\n        let polygon2Divide2Line = turf.polygonToLine(geojsonRepresentation);\n        polygon2Divide2Line.geometry.coordinates.push(splitFeature.getGeometry().coordinates);\n        // eslint-disable-next-line no-undef\n        let poligonos = turf.lineToPolygon(polygon2Divide2Line);\n        // eslint-disable-next-line no-undef\n        newHole = turf.polygon([poligonos.geometry.coordinates[poligonos.geometry.coordinates.length - 1]]);\n        return dividePolygonWithHoles(newHole, selectedFeature);\n      } catch (e) {\n        return null;\n      }\n    }\n\n    let exteriorRingTargetPoly = polygon2Divide.getExteriorRing();\n    let polygonizerTarget = new jsts.operation.polygonize.Polygonizer();\n    polygonizerTarget.add(exteriorRingTargetPoly);\n\n\n    if (polygonizer.getGeometry().getArea() - polygonizerTarget.getGeometry().getArea() > 0.1) {\n      return -1;\n    } else {\n      if (polygon2Divide.getNumInteriorRing() > 0) {\n        if (!line4Divide.isSimple()) {\n          newHole = getNewHolePolygon(polygon2Divide, line4Divide);\n          return dividePolygonWithHolesJSTS(newHole, polygon2Divide, selectedFeature);\n        } else {\n          var result = getPolygonsOnHoles(polygonizer, polygon2Divide);\n          return dividePolygonWithHolesJSTS(null, result, selectedFeature);\n        }\n      } else if (polygons.size() < 2) {\n        return null;\n      }\n\n      return createDividedPolygons(polygons2Create, selectedFeature);\n    }\n  } catch (e) {\n    //User has tried to divide a multipolygon\n    return undefined;\n  }\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const getNewHolePolygon = (polygon2Divide, line4Divide) => {\n  let polygonizerHole = new jsts.operation.polygonize.Polygonizer();\n  let union = polygon2Divide.getExteriorRing().union(line4Divide);\n  polygonizerHole.add(union);\n  let polygons = polygonizerHole.getPolygons();\n  for (let i = polygons.iterator(); i.hasNext();) {\n    const polygon = i.next();\n    if (polygon._holes.length > 0) {\n      polygonizerHole.add(polygon._holes[0]);\n      return polygonizerHole.getPolygons().get(0);\n    }\n  }\n  return false;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const getPolygonsOnHoles = (polygonizer, polygon2Divide) => {\n  let polygons = polygonizer.getPolygons();\n  let polygonizerHoles = new jsts.operation.polygonize.Polygonizer();\n  let poly1 = polygons.get(0);\n  let poly2 = null;\n\n  for (let i = 0; i < polygon2Divide._holes.length; i++) {\n    polygonizerHoles.add(polygon2Divide._holes[i]);\n  }\n\n  let holes = polygonizerHoles.getPolygons();\n\n  if (polygons.size() === 2) {\n    poly2 = polygons.get(1);\n  }\n\n  for (let j = holes.iterator(); j.hasNext();) {\n    const hole = j.next();\n    poly1 = poly1.difference(hole);\n    if (poly2 !== null)\n      poly2 = poly2.difference(hole);\n  }\n\n  let result = [];\n  result.push(poly1);\n  if (poly2 !== null)\n    result.push(poly2);\n\n  return result;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const dividePolygonWithHolesJSTS = (newHole, polygon2Divide, selectedFeature) => {\n  let polygonGeoJson, newFeature;\n  let resultFeatures = [];\n  let cont = 1;\n\n  let newPolygons = [];\n\n  if (newHole !== null) {\n    var targetPolygonNoHoles = selectedFeature.getGeometry();\n\n    var olNewTargetFeatureJSTS = polygon2Divide.difference(newHole);\n    var newHoleFeatureJSTS = newHole.intersection(polygon2Divide);\n\n    var olNewTargetFeatureJSTSgj = getGeoJSONGeometry(olNewTargetFeatureJSTS);\n    var newHoleFeatureJSTSgj = getGeoJSONGeometry(newHoleFeatureJSTS);\n\n    if (olNewTargetFeatureJSTSgj !== null && newHoleFeatureJSTSgj !== null) {\n      targetPolygonNoHoles = olNewTargetFeatureJSTSgj;\n      newHole = newHoleFeatureJSTSgj;\n      newPolygons.push(targetPolygonNoHoles);\n      newPolygons.push(newHole);\n    } else {\n      return -1;\n    }\n\n    for (let i = 0; i < newPolygons.length; i++) {\n      newFeature = new M.Feature(Math.random(), {\n        \"type\": \"Feature\",\n        \"id\": Math.random(),\n        \"geometry\": newPolygons[i],\n        \"geometry_name\": \"geometry\",\n        \"properties\": {}\n      });\n      resultFeatures.push(newFeature);\n      cont += cont;\n    }\n  } else {\n    newPolygons = polygon2Divide;\n\n    for (let i = 0; i < newPolygons.length; i++) {\n      polygonGeoJson = getGeoJSONGeometry(newPolygons[i]);\n      newFeature = new M.Feature(Math.random(), {\n        \"type\": \"Feature\",\n        \"id\": Math.random(),\n        \"geometry\": polygonGeoJson,\n        \"geometry_name\": \"geometry\",\n        \"properties\": {}\n      });\n      resultFeatures.push(newFeature);\n      cont++;\n    }\n  }\n\n  return resultFeatures;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const dividePolygonWithHoles = (newHole, selectedFeature) => {\n  let resultFeatures = [];\n  var cont = 1;\n  let newPolygons = [];\n  let geomSelected = selectedFeature.getGeometry();\n  let geojsonRepresentation = geomSelected;\n  let targetPolygonNoHoles = geojsonRepresentation;\n\n  try {\n    // eslint-disable-next-line no-undef\n    if (!turf.booleanContains(targetPolygonNoHoles, newHole) && !turf.booleanOverlap(targetPolygonNoHoles, newHole)) {\n      return -1;\n    }\n    let targetPolygonNoHolesJSTS = getJSTSGeometry(geomSelected);\n    var newHoleJSTS = getJSTSGeometry(newHole.geometry);\n    var olNewTargetFeatureJSTS = targetPolygonNoHolesJSTS.difference(newHoleJSTS);\n    var newHoleFeatureJSTS = newHoleJSTS.intersection(targetPolygonNoHolesJSTS);\n\n    var olNewTargetFeatureJSTSgj = getGeoJSONGeometry(olNewTargetFeatureJSTS);\n    var newHoleFeatureJSTSgj = getGeoJSONGeometry(newHoleFeatureJSTS);\n\n    if (olNewTargetFeatureJSTSgj !== null && newHoleFeatureJSTSgj !== null) {\n      targetPolygonNoHoles.geometry = olNewTargetFeatureJSTSgj;\n      newHole.geometry = newHoleFeatureJSTSgj;\n      newPolygons.push(targetPolygonNoHoles);\n      newPolygons.push(newHole);\n    } else {\n      return -1;\n    }\n\n  } catch (e) {\n    return -2;\n  }\n\n  for (let i = 0; i < newPolygons.length; i++) {\n    var newFeature = new M.Feature(Math.random(), {\n      \"type\": \"Feature\",\n      \"id\": Math.random(),\n      \"geometry\": newPolygons[i],\n      \"geometry_name\": \"geometry\",\n      \"properties\": {}\n    });\n    resultFeatures.push(newFeature);\n    cont += cont;\n  }\n\n  return resultFeatures;\n};\n\n/**\n * Zooms the view to the layer extent\n *\n * @public\n * @function\n * @api stable\n */\nexport const createDividedPolygons = (polygons, selectedFeature) => {\n  let resultFeatures = [];\n  let cont = 1;\n\n  for (let i = polygons.iterator(); i.hasNext();) {\n    const polygon = i.next();\n    let polygonGeoJson = getGeoJSONGeometry(polygon);\n    let newFeature = new M.Feature(Math.random(), selectedFeature.getGeoJSON());\n    newFeature.setGeometry(polygonGeoJson);\n    resultFeatures.push(newFeature);\n    cont += cont;\n  }\n\n  return resultFeatures;\n};\n","import EditionGeometryControlImpl from 'impl/editionGeometryControl';\nimport {\n  show,\n  close\n} from './editionDialog';\nimport {\n  unionFeature,\n  intersects,\n  intersection,\n  difference,\n  dividePolygon,\n  getJSTSGeometry\n} from './editionSpatialEngine';\nimport { getValue } from './i18n/language';\n\n// @namespace(\"M.control\")\nexport default class EditionGeometryControl extends EditionGeometryControlImpl {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a EditionGeometryControl\n   * control\n   *\n   * @constructor\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(base) {\n    if (M.utils.isUndefined(EditionGeometryControlImpl)) {\n      M.exception('La implementación usada no puede crear controles EditionGeometryControl');\n    }\n\n    let impl_ = new EditionGeometryControlImpl(base.facadeMap_);\n    super(impl_, \"editionGeometryControl\");\n\n    this.NAME = \"editionGeometryControl\";\n    this.impl_ = impl_;\n\n    this.facadeMap_ = base.facadeMap_;\n    /**\n     * Parent prototype by dependency injection\n     * @private\n     * @type {Object}\n     */\n    this.base = base;\n    /**\n     * Html Element\n     * @private\n     * @type {Object}\n     */\n    this.element_ = base.element_;\n    /**\n     * Layer for use in control\n     * @private\n     * @type {Object}\n     */\n    this.entityLayer_ = base.sandBoxLayer_;\n    /**\n     * InsertGeomControl control\n     * @private\n     * @type {Object}\n     */\n    this.insertGeomControl = this.base.insertGeomControl;\n    /**\n     * insertTemporalGeomControl control\n     * @private\n     * @type {Object}\n     */\n    this.insertTemporalGeomControl = this.base.insertTemporalGeomControl;\n    /**\n     * modifyGeomControl control\n     * @private\n     * @type {Object}\n     */\n    this.modifyGeomControl = this.base.modifyGeomControl;\n    /**\n     * translateGeomControl control\n     * @private\n     * @type {Object}\n     */\n    this.translateGeomControl = this.base.translateGeomControl;\n    /**\n     * selectGeomControl control\n     * @private\n     * @type {Object}\n     */\n    this.selectGeomControl = this.base.selectGeomControl;\n    /**\n     * snappingControl control\n     * @private\n     * @type {Object}\n     */\n    this.snappingControl = this.base.snappingControl;\n    /**\n     * highlightControl control\n     * @private\n     * @type {Object}\n     */\n    this.highlightControl = this.base.highlightControl;\n    /**\n     * entityAddWFSControl control\n     * @private\n     * @type {Object}\n     */\n    this.entityAddWFSControl = null;\n    /**\n     * insertPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.insertPolygonButton = null;\n    /**\n     * selectPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.selectPolygonButton = null;\n    /**\n     * selectPolygonByAreaButton button\n     * @private\n     * @type {Object}\n     */\n    this.selectPolygonByAreaButton = null;\n    /**\n     * selectPolygonByLineButton button\n     * @private\n     * @type {Object}\n     */\n    this.selectPolygonByLineButton = null;\n    /**\n     * selectAllSandboxPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.selectAllSandboxPolygonButton = null;\n    /**\n     * modifyPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.modifyPolygonButton = null;\n    /**\n     * dividePolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.dividePolygonButton = null;\n    /**\n     * joinPolygonsButton button\n     * @private\n     * @type {Object}\n     */\n    this.joinPolygonsButton = null;\n    /**\n     * intersectPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.intersectPolygonButton = null;\n    /**\n     * emptyPolygonButton button\n     * @private\n     * @type {Object}\n     */\n    this.emptyPolygonButton = null;\n    /**\n     * zoomToSelectedButton button\n     * @private\n     * @type {Object}\n     */\n    this.zoomToSelectedButton = null;\n    /**\n     * addGeomButton button\n     * @private\n     * @type {Object}\n     */\n    this.addGeomButton = null;\n    /**\n     * WFSManager control\n     * @private\n     * @type {Object}\n     */\n    this.WFSManagerCtl = null;\n\n    this.addEvents();\n\n\n  }\n\n\n  /**\n   * This function add the events to the specified html element\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  addEvents() {\n    this.self_ = this;\n    this.snappingButton = this.element_.querySelector('#m-snapping-button');\n    this.snappingButton.addEventListener('click', this.activateSnapping.bind(this), false);\n\n    this.zoomMenuElement = this.element_.querySelector('#m-zoommenu-button');\n    this.zoomMenuPolygonButton = this.element_.querySelector('#m-zoom-button');\n    this.zoomMenuPolygonButtonClass = this.zoomMenuPolygonButton.classList.value;\n    this.zoomMenuPolygonButton.addEventListener('click', this.manageSelectedClassInDropdown, false);\n    this.zoomMenuElement.addEventListener('mouseover', this.showDropdownContent, false);\n\n    this.zoomMenuElement.addEventListener('mouseout', this.hideDropdownContent, false);\n\n    this.zoomDropdownMenu = this.zoomMenuElement.querySelector('#myDropdown');\n\n    this.zoomToSandBoxButton = this.element_.querySelector('button#m-zoomsandbox-button');\n    this.zoomToSandBoxButton.addEventListener('click', this.zoomToSandBox.bind(this), false);\n\n    this.zoomToSelectedButton = this.element_.querySelector('button#m-zoomselect-button');\n    this.zoomToSelectedButton.addEventListener('click', this.zoomToSelection.bind(this), false);\n\n\n    this.selectMenuElement = this.element_.querySelector('#m-selectmenu-button');\n    this.selectMenuPolygonButton = this.element_.querySelector('#m-select-button');\n    this.selectMenuPolygonButtonClass = this.selectMenuPolygonButton.classList.value;\n    this.selectMenuPolygonButton.addEventListener('click', this.manageSelectedClassInDropdown, false);\n    this.selectMenuElement.addEventListener('mouseover', this.showDropdownContent, false);\n\n    this.selectDropdownMenu = this.selectMenuElement.querySelector('#myDropdown');\n    this.selectMenuElement.addEventListener('mouseout', this.hideDropdownContent, false);\n\n\n    this.removeFromSandBoxButton = this.element_.querySelector('button#m-removefromsandbox-button');\n    this.removeFromSandBoxButton.addEventListener('click', this.removeSelectedFeaturesFromSandBox.bind(this), false);\n\n    this.selectPolygonButton = this.element_.querySelector('button#m-selectclick-button');\n    this.selectPolygonButton.addEventListener('click', this.selectPolygonByClick.bind(this), false);\n\n    this.selectPolygonByAreaButton = this.element_.querySelector('button#m-selectarea-button');\n    this.selectPolygonByAreaButton.addEventListener('click', this.selectPolygonByDraw.bind(this), false);\n\n    this.selectPolygonByLineButton = this.element_.querySelector('button#m-selectline-button');\n    this.selectPolygonByLineButton.addEventListener('click', this.selectPolygonByDraw.bind(this), false);\n\n    this.selectAllSandboxPolygonButton = this.element_.querySelector('button#m-selectall-button');\n    this.selectAllSandboxPolygonButton.addEventListener('click', this.selectAllSandboxPolygon.bind(this), false);\n\n    this.deselectAllSandboxPolygonButton = this.element_.querySelector('button#m-deselectall-button');\n    this.deselectAllSandboxPolygonButton.addEventListener('click', this.deselectAllSandboxPolygon.bind(this), false);\n\n    this.insertPolygonButton = this.element_.querySelector('button#m-draw-button');\n    this.insertPolygonButton.addEventListener('click', this.insertPolygon.bind(this), false);\n\n    this.modifyPolygonButton = this.element_.querySelector('button#m-modify-button');\n    this.modifyPolygonButton.addEventListener('click', this.modifyPolygon.bind(this), false);\n\n    this.dividePolygonButton = this.element_.getElementsByTagName('button')['m-splitpolygon-button'];\n    this.dividePolygonButton.addEventListener('click', this.dividePolygon.bind(this), false);\n\n    this.joinPolygonsButton = this.element_.querySelector('button#m-unir-button');\n    this.joinPolygonsButton.addEventListener('click', this.confirmDialogJoinPolygons.bind(this), false);\n\n    this.addGeomButton = this.element_.querySelector('button#m-addgeometry-button');\n    this.addGeomButton.addEventListener('click', this.addGeom.bind(this), false);\n\n    this.intersectPolygonButton = this.element_.querySelector('button#m-intersect-button');\n    this.intersectPolygonButton.addEventListener('click', this.intersectPolygon.bind(this), false);\n\n    this.emptyPolygonButton = this.element_.querySelector('button#m-vaciado-button');\n    this.emptyPolygonButton.addEventListener('click', this.emptyPolygon.bind(this), false);\n  }\n\n\n  /**\n   * This function shows the dropdown content\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  showDropdownContent(evt) {\n    if (evt.currentTarget.children[1].style.width === \"\" || evt.currentTarget.children[1].style.width === \"0px\") {\n      evt.currentTarget.children[0].style.float = \"left\";\n      evt.currentTarget.children[1].style.left = \"40px\";\n      if (evt.currentTarget.id === \"m-zoommenu-button\") {\n        evt.currentTarget.children[1].style.width = \"80px\";\n      } else {\n        evt.currentTarget.children[1].style.width = \"200px\";\n      }\n      evt.currentTarget.children[1].style.borderTopRightRadius = '4px';\n      evt.currentTarget.children[1].style.borderBottomRightRadius = '4px';\n      evt.currentTarget.children[0].style.marginBottom = \"-4px\";\n    }\n  }\n\n  /**\n   * This function hides the dropdown content\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  hideDropdownContent(evt) {\n    evt.currentTarget.children[1].style.width = \"0px\";\n  }\n\n  /**\n   * This function manages the selected class in dropdown\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  manageSelectedClassInDropdown(evt) {\n    var selectedClass;\n    if (evt.currentTarget.id === 'm-select-button' && evt.currentTarget.classList.value !== 'g-cartografia-flecha') {\n      if (this.selectMenuPolygonButtonClass === 'g-cartografia-flecha') {\n        selectedClass = this.selectMenuPolygonButtonClass;\n        evt.currentTarget.nextElementSibling.style.width = \"0px\";\n        evt.currentTarget.classList.value = selectedClass;\n        this.deactiveControls();\n      }\n    } else if (evt.currentTarget.offsetParent.previousElementSibling !== null && evt.currentTarget.offsetParent.previousElementSibling.id !== \"m-zoom-button\") {\n      selectedClass = evt.currentTarget.classList.value;\n      evt.currentTarget.offsetParent.style.width = \"0px\";\n      evt.currentTarget.offsetParent.previousElementSibling.classList.value = selectedClass;\n    }\n  }\n\n  /**\n   * This function restore the default class in dropdown buttons\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  restoreDefaultClassDropdownButtons() {\n    this.selectMenuPolygonButton.classList.value = this.selectMenuPolygonButtonClass;\n  }\n\n  /**\n   * This function show a confirmation dialog for removing the selected features from SandBox Layer\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeSelectedFeaturesFromSandBox(evt) {\n    if (this.entityLayer_.selectedFeatures_.length > 0) {\n      var acceptFn = this.removeSelectedFeatures.bind(this);\n      show(getValue('dialog_removeFeatures'),\n        getValue('dialog_removeFeatures_title'), 'info', acceptFn);\n    } else {\n      M.dialog.info(getValue('dialog_removeFeatures_noGeometry'), getValue('dialog_removeFeatures_title'));\n    }\n  }\n\n  /**\n   * This function removes the selected features from SandBox Layer\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  removeSelectedFeatures() {\n    this.deactiveControls();\n    this.unselectControls();\n    this.entityLayer_.removeFeaturesFromSandBox(this.entityLayer_.selectedFeatures_);\n    close();\n  }\n\n  /**\n   * This function activate the snapping interaction\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  activateSnapping(evt) {\n    if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n      evt.currentTarget.className += \" selected\";\n      evt.currentTarget.title = getValue('snapping_disable');\n      this.snappingControl.activate(null, null);\n    } else {\n      evt.currentTarget.title = getValue('snapping');\n      evt.currentTarget.className = this.snappingButton.className.replace(\" selected\", \"\");\n      this.snappingControl.deactivate();\n    }\n  }\n\n  /**\n   * This function activate the insert geometry interaction\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  insertPolygon(evt) {\n    this.restoreDefaultClassDropdownButtons();\n    this.deactiveControls();\n    if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.className += \" selected\";\n      var callback = this.onPolygonInserted.bind(this);\n      this.insertGeomControl.activate(callback);\n      this.snappingControl.deactivate();\n      if (this.snappingButton.className.indexOf(\"selected\") > 0) {\n        this.snappingControl.activate(null, null);\n      }\n    } else {\n      this.unselectControls();\n    }\n  }\n\n  /**\n   * Callback for the insert geometry interaction\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonInserted(evt) {\n    this.entityLayer_.addNewFeatureToSandBox(evt.feature);\n  }\n\n  /**\n   * This function activate the select geometry interaction by single click\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  selectPolygonByClick(evt) {\n    this.manageSelectedClassInDropdown(evt);\n    this.deactiveControls();\n    if (evt.currentTarget.offsetParent.previousElementSibling.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.offsetParent.previousElementSibling.className += \" selected\";\n      var callback = this.onPolygonSelected.bind(this);\n      this.selectGeomControl.activate(callback);\n    } else {\n      this.showDropdownContent();\n    }\n  }\n\n  /**\n   * Callback for the select geometry interaction by single click\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonSelected(evt) {\n    var this_ = this;\n    var featureInSandBox = null;\n    if (evt.selected.length > 0) {\n      var sandBoxFeatures = this.entityLayer_.getFeatures();\n      sandBoxFeatures.forEach(function (f, index, array) {\n        for (let i = 0; i < evt.selected.length; i++) {\n          if (evt.selected[i].getId() === this_.entityLayer_.getImplFeature(f).getId()) {\n            featureInSandBox = evt.selected[i];\n          }\n        }\n      });\n\n      if (featureInSandBox !== null) {\n        var selected = null;\n        this.entityLayer_.selectedFeatures_.forEach(function (f, index, array) {\n          for (let i = 0; i < evt.selected.length; i++) {\n            if (evt.selected[i].getId() === this_.entityLayer_.getImplFeature(f).getId()) {\n              selected = evt.selected[i];\n            }\n          }\n        });\n        if (selected === null) {\n          this.entityLayer_.selectFeature(featureInSandBox);\n        } else {\n          this.entityLayer_.unselectFeature(featureInSandBox);\n        }\n      }\n\n      evt.target.getFeatures().clear();\n    }\n  }\n\n  /**\n   * This function activate the select geometry interaction by drawing a polygon\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  selectPolygonByDraw(evt) {\n    this.manageSelectedClassInDropdown(evt);\n    var geometryType = evt.currentTarget.id === 'm-selectarea-button' ? 'Polygon' : 'LineString';\n    this.deactiveControls();\n    if (evt.currentTarget.offsetParent.previousElementSibling.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.offsetParent.previousElementSibling.className += \" selected\";\n      var callback = this.onPolygonSelectedByDraw.bind(this);\n      this.insertTemporalGeomControl.activate(callback, geometryType);\n    } else {\n      this.showDropdownContent();\n    }\n  }\n\n  /**\n   * Callback for the select geometry interaction by drawing a polygon\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonSelectedByDraw(evt) {\n    var sandBoxFeatures = this.entityLayer_.getFeatures();\n    //var inter = intersects(sandBoxFeatures, evt.feature.getGeometry());\n    var inter = intersects(sandBoxFeatures, this.impl_.getGeoJsonFromFeature(evt.feature).geometry);\n    for (var i = 0; i < inter.length; i++) {\n      var featureInSandBox = null;\n      sandBoxFeatures.forEach(function (f, index, array) {\n        //if(inter[i].getId()===this_.entityLayer_.getImplFeature(f).getId()){\n        if (inter[i].getId() === f.getId()) {\n          featureInSandBox = inter[i];\n        }\n      });\n\n      if (featureInSandBox !== null) {\n        var selected = null;\n        this.entityLayer_.selectedFeatures_.forEach(function (f, index, array) {\n          //if(inter[i].getId()===this_.entityLayer_.getImplFeature(f).getId()){\n          if (inter[i].getId() === f.getId()) {\n            selected = inter[i];\n          }\n        });\n        if (selected === null) {\n          this.entityLayer_.selectFeature(featureInSandBox);\n        } else {\n          this.entityLayer_.unselectFeature(featureInSandBox);\n        }\n      }\n    }\n  }\n\n  /**\n   * This function selects all features in sandboxlayer\n   *\t\n   * @public\n   * @function\n   * @api stable\n   */\n  selectAllSandboxPolygon() {\n    if (this.entityLayer_.getFeatures().length > 0) {\n      this.deactiveControls();\n      this.unselectControls();\n      this.entityLayer_.selectAllFeatures();\n    } else {\n      M.dialog.info(getValue('dialog_noGeometry'));\n    }\n  }\n\n  /**\n   * This function deselects all features in sandboxlayer\n   *\t\n   * @public\n   * @function\n   * @api stable\n   */\n  deselectAllSandboxPolygon() {\n    if (this.entityLayer_.selectedFeatures_.length > 0) {\n      this.deactiveControls();\n      this.unselectControls();\n      this.entityLayer_.unselectAllFeatures();\n    } else {\n      M.dialog.info(getValue('dialog_noGeometry_selected'));\n    }\n  }\n\n  /**\n   * This function activate the modify geometry interaction\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  modifyPolygon(evt) {\n    if (this.entityLayer_.selectedFeatures_.length > 0) {\n      this.restoreDefaultClassDropdownButtons();\n      this.deactiveControls();\n      if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n        this.unselectControls();\n        evt.currentTarget.className += \" selected\";\n        var featuresSelected = this.entityLayer_.selectedFeatures_;\n        for (let i = 0; i < featuresSelected.length; i++) {\n          var styles = this.impl_.getModifyStyle(this.entityLayer_.getImplFeature(featuresSelected[i]));\n          this.entityLayer_.getImplFeature(featuresSelected[i]).setStyle(styles);\n        }\n        var callback = this.onPolygonModified.bind(this);\n        this.modifyGeomControl.activate(callback);\n        this.snappingControl.deactivate();\n        if (this.snappingButton.className.indexOf(\"selected\") > 0) {\n          this.snappingControl.activate(null, null);\n        }\n      } else {\n        this.unselectControls();\n      }\n    } else {\n      M.dialog.info(getValue('dialog_noGeometry_selected'));\n    }\n  }\n\n  /**\n   * Callback for the modify geometry interaction\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonModified(evt) {\n    // eslint-disable-next-line no-unused-vars\n    let olFeature = null;\n    const features = evt.features.getArray();\n    for (var i = 0; i < features.length; i++) {\n      var rev = features[i].getRevision();\n      if (rev > 1) {\n        // eslint-disable-next-line no-unused-vars\n        let olFeature = features[i];\n      }\n    }\n  }\n\n  /**\n   * This function activate the insert line interaction in order to divide selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  dividePolygon(evt) {\n    this.restoreDefaultClassDropdownButtons();\n    this.deactiveControls();\n    if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.className += \" selected\";\n      var callback = this.onPolygonDivided.bind(this);\n      this.insertTemporalGeomControl.activate(callback, 'LineString');\n      document.body.style.cursor = 'pointer';\n    } else {\n      this.unselectControls();\n    }\n  }\n\n  /**\n   * Callback for the insert line interaction in order to divide selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonDivided(evt) {\n    var inter;\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    var resultPolygons = [];\n    if (featuresSelected.length > 0) {\n      var feature = new M.Feature(Math.floor(Math.random() * 1000000), this.impl_.getGeoJsonFromFeature(evt.feature));\n      inter = intersects(featuresSelected, feature.getGeometry());\n      for (var i = 0; i < inter.length; i++) {\n        resultPolygons.push(dividePolygon(feature, inter[i]));\n      }\n      var topologicalError = false;\n      for (var j = 0; j < resultPolygons.length; j++) {\n        if (resultPolygons[j] === 0 || resultPolygons[j] === -1 || resultPolygons[j] === -2 || resultPolygons[j] === undefined || resultPolygons[j] === null) {\n          topologicalError = true;\n        }\n      }\n      if (!topologicalError) {\n        for (var k = 0; k < resultPolygons.length; k++) {\n          this.entityLayer_.addFeatures(resultPolygons[k]);\n        }\n        this.entityLayer_.removeFeaturesFromSandBox(inter);\n      } else {\n        M.dialog.info(getValue('dialog_noValidGeometry'), getValue('geometry_divide'));\n      }\n    } else {\n      M.dialog.info(getValue('dialog_atLeast_oneSelected'), getValue('geometry_divide'));\n      return;\n    }\n  }\n\n  /**\n   * This function show a confirmation dialog for joining selected features\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  confirmDialogJoinPolygons(evt) {\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    if (featuresSelected.length > 1) {\n      var acceptFn = this.joinPolygons.bind(this);\n      show(getValue('dialog_union'),\n        getValue('dialog_union_title'), 'info', acceptFn);\n    } else {\n      M.dialog.info(getValue('dialog_atLeast_twoSelected'), getValue('dialog_union_title'));\n    }\n  }\n\n  /**\n   * This function joins adjacent selected polygons\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  // revisada\n  joinPolygons() {\n    var featuresSelected = this.entityLayer_.selectedFeatures_,\n      pairTargetPolygons = [],\n      targetPolygon,\n      polygonsToDelete = [],\n      union, areAdjacentPolygons, newFeature,\n      polygonsToVerify = [];\n    this.restoreDefaultClassDropdownButtons();\n    close();\n    for (let i = 0; i < featuresSelected.length; i++) {\n      var clone = new M.Feature(featuresSelected[i].getId(), {\n        \"type\": \"Feature\",\n        \"geometry\": featuresSelected[i].getGeometry(),\n        \"geometry_name\": \"geometry\",\n        \"properties\": {}\n      });\n      polygonsToVerify.push(clone);\n    }\n    if (featuresSelected.length > 0) {\n      this.deactiveControls();\n      this.unselectControls();\n      for (let j = 0; j < featuresSelected.length; j++) {\n        targetPolygon = featuresSelected[j];\n        for (let k = 0; k < polygonsToVerify.length; k++) {\n          pairTargetPolygons.push(targetPolygon);\n          var jstsGeomFeature1 = getJSTSGeometry(targetPolygon.getGeometry());\n          var jstsGeomFeature2 = getJSTSGeometry(polygonsToVerify[k].getGeometry());\n          areAdjacentPolygons = jstsGeomFeature1.intersects(jstsGeomFeature2);\n          if (areAdjacentPolygons === true && targetPolygon.equals(polygonsToVerify[k]) === false) {\n            polygonsToDelete.push(this.entityLayer_.getImplFeature(targetPolygon));\n            pairTargetPolygons.push(polygonsToVerify[k]);\n            union = unionFeature(pairTargetPolygons[0], pairTargetPolygons[1]);\n            union.setId(Math.floor(Math.random() * 1000000));\n            pairTargetPolygons = [];\n            this.entityLayer_.addNewMFeatureToSandBox(union);\n            polygonsToDelete.push(polygonsToVerify[k]);\n            this.entityLayer_.removeFeaturesFromSandBox(polygonsToDelete);\n            for (let l = 0; l < polygonsToDelete.length; l++) {\n              var index = polygonsToVerify.indexOf(polygonsToDelete[l]);\n              if (index > -1) {\n                polygonsToVerify.splice(index, 1);\n              }\n            }\n            var jsonFeature = union.getGeoJSON();\n            newFeature = new M.Feature(union.getId(), jsonFeature);\n            targetPolygon = newFeature;\n            k = 0;\n            j = 0;\n          } else {\n            pairTargetPolygons = [];\n          }\n        }\n      }\n    } else {\n      M.dialog.info(getValue('dialog_atLeast_twoSelected'));\n      return;\n    }\n  }\n\n  /**\n   * This function activate the select geometry interaction in order to intersect selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  intersectPolygon(evt) {\n    this.restoreDefaultClassDropdownButtons();\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    if (featuresSelected.length === 0) {\n      M.dialog.info(getValue('dialog_removeFeatures_noGeometry'), getValue('dialog_intersect_title'));\n      return;\n    }\n    this.deactiveControls();\n    if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.className += \" selected\";\n      document.body.style.cursor = 'pointer';\n      var callback = this.onPolygonIntersected.bind(this);\n      this.selectGeomControl.activate(callback);\n      this.highlightControl.activate();\n    } else {\n      this.highlightControl.deactivate();\n      this.unselectControls();\n    }\n  }\n\n  /**\n   * Callback for the select geometry interaction in order to intersect selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onPolygonIntersected(evt) {\n    var inter, featuresSelected;\n    featuresSelected = this.entityLayer_.selectedFeatures_;\n    if (featuresSelected.length > 0) {\n      inter = intersects(featuresSelected, this.entityLayer_.getMFeatureById(evt.selected[0].getId()).getGeometry());\n      if (inter.length > 0) {\n        var args = [];\n        args.push(inter);\n        args.push(this.entityLayer_.getMFeatureById(evt.selected[0].getId()));\n        this.doSpatialProcess(intersection, args);\n        this.clear();\n      }\n    }\n  }\n\n  /**\n   * This function activate the select geometry interaction in order to empty selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  emptyPolygon(evt) {\n    this.restoreDefaultClassDropdownButtons();\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    if (featuresSelected.length === 0) {\n      M.dialog.info(getValue('dialog_removeFeatures_noGeometry'), getValue('dialog_empty_title'));\n      return;\n    }\n    this.deactiveControls();\n    if (evt.currentTarget.className.indexOf(\"selected\") < 0) {\n      this.unselectControls();\n      evt.currentTarget.className += \" selected\";\n      document.body.style.cursor = 'pointer';\n      var callback = this.onGeometryEmptied.bind(this);\n      this.selectGeomControl.activate(callback);\n      this.highlightControl.activate();\n    } else {\n      this.highlightControl.deactivate();\n      this.unselectControls();\n    }\n  }\n\n  /**\n   * Callback for the select geometry interaction in order to empty selected polygons\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  onGeometryEmptied(evt) {\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    if (featuresSelected.length > 0) {\n      var args = [];\n      args.push(featuresSelected);\n      args.push(this.entityLayer_.getMFeatureById(evt.selected[0].getId()));\n      this.doSpatialProcess(difference, args);\n      this.clear();\n    }\n  }\n\n  /**\n   * This function launch the spatialProcess\n   *\n   * @public\n   * @function\n   * @param {Object} fnProcess - process function in editionSpatialEngine\n   * @param {Array} args - arguments for fnProcess function\n   * @api stable\n   */\n  doSpatialProcess(fnProcess, args) {\n    var featuresSelected = args[0];\n    var plantillaRecorte = args[1];\n\n    for (let i = 0; i < featuresSelected.length; i++) {\n      var olFeature = featuresSelected[i];\n\n      if (plantillaRecorte !== olFeature) {\n        var difference = fnProcess.apply(this, [olFeature, plantillaRecorte]);\n        var feature = new M.Feature(Math.floor(Math.random() * 1000000) + 1, {\n          \"type\": \"Feature\",\n          \"geometry\": difference,\n          \"geometry_name\": \"geometry\",\n          \"properties\": {}\n        });\n        if (feature.getGeometry().type === \"MultiPolygon\") {\n          var featureTmp = this.impl_.createOLPolygonFeature(feature);\n          this.entityLayer_.addNewMFeatureToSandBox(featureTmp);\n        } else {\n          this.entityLayer_.addNewMFeatureToSandBox(feature);\n        }\n      }\n\n      if (featuresSelected.length > 1 || (featuresSelected.length === 1 && plantillaRecorte !== olFeature)) {\n        this.entityLayer_.removeFeaturesFromSandBox([olFeature]);\n      }\n    }\n  }\n\n  addGeom(evt) {\n    let capasVectoriales = [];\n    this.facadeMap_.getLayers().forEach(function (layer) {\n      if (layer instanceof M.layer.Vector && layer.name != 'editionLayer') {\n        if (layer.getFeatures().length > 0) {\n          capasVectoriales.push(layer);\n        }\n      }\n    });\n\n    var acceptFn = this.addGeomFromVectorialLayer.bind(this);\n    show(getValue('dialog_add_geometry'),\n      getValue('dialog_add_geometry_title'), 'info', acceptFn, undefined, capasVectoriales);\n  }\n\n  addGeomFromVectorialLayer(layerName) {\n    // TODO: Resolver asincronia de spinner\n    //showSpinner(mapContainer);\n    let layerVectorial = this.facadeMap_.getLayers({ 'name': layerName })[0];\n    // TODO: Se debe vaciar la capa sanbox antes de copiar los nuevos elementos?\n    this.entityLayer_.removeAllFeatures();\n    // Se cambia el tipo de geometria si es necesario\n    // Sabemos que la capa no esta vacia\n    let tipoGeometria = layerVectorial.getFeatures()[0].getGeometry().type;\n    this.entityLayer_.setType(tipoGeometria);\n\n    // Se clonan y añaden los features\n    layerVectorial.getFeatures().forEach(element => {\n      // En principio se clonan los features, con atributos\n      // TODO: M.utils.extends, recursion\n      let json = element.getGeoJSON();\n      let clon = new M.Feature(element.getId(), json);\n\n      this.entityLayer_.addNewMFeatureToSandBox(clon);\n    });\n    //closeSpinner(mapContainer);\n    close();\n\n  }\n\n\n  /**\n   * This function checks if WFSManager Plugin is loaded\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  checkWFSManagerPlugin() {\n    var wfsCatalog = this.facadeMap_.getPanels('Catalog')[0].getControls()[0];\n    if (wfsCatalog) {\n      for (let i = 0; i < wfsCatalog.controls_.length; i++) {\n        if (wfsCatalog.controls_[i].name === \"WFSManagerControl\") {\n          this.WFSManagerCtl = wfsCatalog.controls_[i];\n        }\n      }\n      return this.WFSManagerCtl !== null;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * This function does a zoom to sandbox layer\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  zoomToSandBox(evt) {\n    this.manageSelectedClassInDropdown(evt);\n    if (this.entityLayer_.getFeatures().length > 0) {\n      this.entityLayer_.zoomToFeatures(this.entityLayer_.getFeatures());\n    } else {\n      M.dialog.info(getValue('dialog_noGeometry'), getValue('dialog_zoom_title'));\n    }\n  }\n\n  /**\n   * This function does a zoom to features selected in sandbox layer\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  zoomToSelection(evt) {\n    this.manageSelectedClassInDropdown(evt);\n    if (this.entityLayer_.selectedFeatures_.length > 0) {\n      this.entityLayer_.zoomToFeatures(this.entityLayer_.selectedFeatures_);\n    } else {\n      M.dialog.info(getValue('dialog_removeFeatures_noGeometry'), getValue('dialog_zoom_select'));\n    }\n  }\n\n  /**\n   * This function does a filtered WFS GetFeature from active service in WFSManager Plugin\n   *\n   * @public\n   * @function\n   * @param {evt} event\n   * @api stable\n   */\n  getWfsFeatures(evt) {\n    var this_ = this;\n    evt.preventDefault();\n    var mapContainer = document.getElementsByClassName(\"m-mapea-container\")[0];\n    M.EditionSpinner.show(mapContainer);\n    var requestParams = this.WFSManagerCtl.getServiceActive();\n    var featureRequest = this.impl_.getFeatureRequestBody(requestParams, evt.coordinate);\n    var options = { jsonp: requestParams.useProxy };\n    var body = new XMLSerializer().serializeToString(featureRequest);\n    M.proxy(requestParams.useProxy);\n\n    M.remote.post(requestParams.url, body, options)\n      .then(function (response) {\n        M.proxy(true);\n        if (response.code === 200) {\n          var numberFeatures = Number(response.xml.documentElement.getAttribute(\"numberOfFeatures\"));\n          if (numberFeatures < 1) {\n            M.EditionSpinner.close(mapContainer);\n            M.dialog.info(getValue('dialog_not_found') + requestParams.description);\n          } else {\n            return response.text;\n          }\n        } else {\n          M.dialog.error(getValue('dialog_cannot_consult'));\n          return;\n        }\n      }).then(function (text) {\n        var features = this_.entityLayer_.readGML3Features(text);\n        if (features.length > 0) {\n          for (let i = 0; i < features.length; i++) {\n            this_.entityLayer_.addNewFeatureToSandBox(features[i]);\n          }\n          M.EditionSpinner.close(mapContainer);\n        } else {\n          M.EditionSpinner.close(mapContainer);\n          M.dialog.info(getValue('dialog_not_found') + requestParams.description);\n        }\n      }).catch(function (e) {\n        M.EditionSpinner.close(mapContainer);\n        M.dialog.error(getValue('dialog_cannot_consult'));\n      });\n  }\n\n  /**\n   * This function deactivates all controls\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  deactiveControls() {\n    this.insertGeomControl.deactivate();\n    this.insertTemporalGeomControl.deactivate();\n    this.modifyGeomControl.deactivate();\n    //this.translateGeomControl.deactivate();\n    this.selectGeomControl.deactivate();\n    this.snappingControl.deactivate();\n    this.highlightControl.deactivate();\n    var mapImpl = this.facadeMap_.getMapImpl();\n    mapImpl.un('click', this.getWfsFeatures, this);\n  }\n\n  /**\n   * This function unselects all controls\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  unselectControls() {\n    this.insertPolygonButton.className = this.insertPolygonButton.className.replace(\" selected\", \"\");\n    this.addGeomButton.className = this.addGeomButton.className.replace(\" selected\", \"\");\n    this.selectPolygonButton.className = this.selectPolygonButton.className.replace(\" selected\", \"\");\n    this.selectPolygonByLineButton.className = this.selectPolygonByLineButton.className.replace(\" selected\", \"\");\n    this.selectPolygonByAreaButton.className = this.selectPolygonByAreaButton.className.replace(\" selected\", \"\");\n    this.modifyPolygonButton.className = this.modifyPolygonButton.className.replace(\" selected\", \"\");\n    this.dividePolygonButton.className = this.dividePolygonButton.className.replace(\" selected\", \"\");\n    this.intersectPolygonButton.className = this.intersectPolygonButton.className.replace(\" selected\", \"\");\n    this.emptyPolygonButton.className = this.emptyPolygonButton.className.replace(\" selected\", \"\");\n    this.removeFromSandBoxButton.className = this.removeFromSandBoxButton.className.replace(\" selected\", \"\");\n\n    var featuresSelected = this.entityLayer_.selectedFeatures_;\n    for (let i = 0; i < featuresSelected.length; i++) {\n      featuresSelected[i].getImpl().getOLFeature().setStyle(this.entityLayer_.getSelectedStyle());\n    }\n\n    document.body.style.cursor = 'default';\n  }\n\n  /**\n   * This function execute both deactivate all controls and unselect all controls functions\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clear() {\n    this.unselectControls();\n    this.deactiveControls();\n  }\n\n  /**\n   * This function checks if an object is equals\n   * to this control\n   *\n   * @public\n   * @function\n   * @param {*} obj - Object to compare\n   * @returns {boolean} equals - Returns if they are equal or not\n   * @api stable\n   */\n  equals(obj) {\n    var equals = false;\n    if (obj instanceof M.control.EditionGeometryControl) {\n      equals = (this.name === obj.name);\n    }\n    return equals;\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.getImpl().destroy();\n  }\n\n}\n","import editionLayer from '../../impl/ol/js/editionLayer';\nimport EditionSelectGeometry from './editionSelectGeometry';\nimport EditionImplControl from 'impl/editioncontrol';\nimport EditionHighlightGeometry from './editionHighlightGeometry';\nimport EditionInsertGeometry from './editionInsertGeometry';\nimport EditionModifyGeometry from './editionModifyGeometry';\nimport EditionTemporalGeometry from './editionInsertTemporalGeometry';\nimport EditionSnapping from './editionSnapping';\nimport EditionGeometryControl from './editionGeometryControl';\nimport template from 'templates/edition';\nimport { getValue } from './i18n/language';\n\n// @namespace(\"M.control\")\nexport default class editionControl extends M.Control {\n\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a PluginControl\n   * control\n   *\n   * @constructor\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor() {\n    // 1. checks if the implementation can create PluginControl\n    if (M.utils.isUndefined(EditionImplControl)) {\n      M.exception('La implementación usada no puede crear controles editionControl');\n    }\n    // 2. implementation of this control\n    let impl = new EditionImplControl();\n    super(impl, \"edition\");\n\n    /**\t\n     * Edition layer\n     * @private\n     * @type {Object}\n     */\n    this.sandBoxLayer_ = null;\n  }\n\n  /**\n   * This function creates the view\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  createView(map) {\n    var this_ = this;\n    this.facadeMap_ = map;\n    return new Promise((success, fail) => {\n      const html = M.template.compileSync(template, {\n        vars: {\n          translations: {\n            import_btn: getValue('import_btn'),\n            select_btn: getValue('select_btn'),\n            select_click: getValue('select_click'),\n            select_line: getValue('select_line'),\n            select_area: getValue('select_area'),\n            select_all: getValue('select_all'),\n            deselect_all: getValue('deselect_all'),\n            zoom: getValue('zoom'),\n            zoom_sandbox: getValue('zoom_sandbox'),\n            zoom_selection: getValue('zoom_selection'),\n            geometry_draw: getValue('geometry_draw'),\n            snapping: getValue('snapping'),\n            modify_polygon: getValue('modify_polygon'),\n            geometry_divide: getValue('geometry_divide'),\n            union: getValue('union'),\n            empty_polygon: getValue('empty_polygon'),\n            intersection: getValue('intersection'),\n            delete_selected: getValue('delete_selected'),\n          },\n        },\n      });\n      this_.element_ = html;\n      this_.sandBoxLayer_ = new editionLayer(this);\n      this_.createControls();\n      success(html);\n    });\n  }\n\n  /**\n   * This function creates the edition controls\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  createControls() {\n    this.highlightControl = new EditionHighlightGeometry(this.facadeMap_, this.sandBoxLayer_);\n    this.insertGeomControl = new EditionInsertGeometry(this.facadeMap_, this.sandBoxLayer_);\n    this.modifyGeomControl = new EditionModifyGeometry(this.facadeMap_, this.sandBoxLayer_);\n    this.insertTemporalGeomControl = new EditionTemporalGeometry(this.facadeMap_, this.sandBoxLayer_);\n    this.snappingControl = new EditionSnapping(this.facadeMap_, this.sandBoxLayer_);\n    this.selectGeomControl = new EditionSelectGeometry(this.facadeMap_, this.sandBoxLayer_);\n    this.geomControl = new EditionGeometryControl(this);\n  }\n\n  /**\n   * This function is called on the control activation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activate() {\n    super.activate();\n  }\n\n  /**\n   * This function is called on the control deactivation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  deactivate() {\n    super.deactivate();\n    this.getImpl().deactivateClick(this.map_);\n  }\n\n  /**\n   * This function gets activation button\n   *\n   * @public\n   * @function\n   * @param {HTML} html of control\n   * @api stable\n   */\n  getActivationButton(html) {\n    return html.querySelector('.m-edition button');\n  }\n\n  /**\n   * This function destroy the controls\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroyControls() {\n    this.geomControl.clear();\n    this.sandBoxLayer_.destroy();\n  }\n\n  /**\n   * This function compares controls\n   *\n   * @public\n   * @function\n   * @param {M.Control} control to compare\n   * @api stable\n   */\n  equals(control) {\n    return control instanceof editionControl;\n  }\n}\n","/**\n * @module M/plugin/Edition\n */\n\nimport 'assets/css/edition.css';\nimport 'templates/edition.html';\nimport EditionControl from './editioncontrol';\nimport api from '../../api.json';\nimport { getValue } from './i18n/language';\n\nexport default class Edition extends M.Plugin {\n\n  /**\n   * Name to identify this plugin\n   * @const\n   * @type {string}\n   * @public\n   * @api stable\n   */\n  static get NAME() {\n    return 'edition';\n  }\n\n  /**\n   * @classdesc\n   * Main facade plugin object. This class creates a plugin\n   * object which has an implementation Object\n   *\n   * @constructor\n   * @extends {M.Plugin}\n   * @param {Object} impl implementation object\n   * @api stable\n   */\n  constructor() {\n\n    super();\n\n    // this.userParameters_ = userParameters;\n    // this.config_ = userParameters ? userParameters.config : {};\n    //this.control_ = null;\n\n    /**\n     * Facade of the map\n     * @private\n     * @type {M.Map}\n     */\n    this.map_ = null;\n\n    /**\n     * Array of controls\n     * @private\n     * @type {Array<M.Control>}\n     */\n    this.controls_ = [];\n\n    /**\n     * Position of the Plugin\n     * @public\n     * Posible values: TR | TL | BL | BR\n     * @type {String}\n     */\n    this.position = 'TL';\n\n    /**\n     * Metadata from api.json\n     * @private\n     * @type {Object}\n     */\n    this.metadata_ = api.metadata;\n\n\n    /**\n     * add your variables\n     *\n     */\n\n  }\n\n  /**\n   * This function adds this plugin into the map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map the map to add the plugin\n   * @api stable\n   */\n  addTo(map) {\n    this.control_ = new EditionControl();\n    this.controls_.push(this.control_);\n    this.map_ = map;\n    //panel para agregar control - no obligatorio\n    this.panel_ = new M.ui.Panel(\"paneledition\", {\n      'collapsible': true,\n      'className': 'm-edition',\n      'collapsedButtonClass': 'g-editiontools-closed',\n      'openedButtonClass': 'g-editiontools-opened-vertical',\n      'position': M.ui.position[this.position],\n      'tooltip': getValue('tooltip')\n    });\n\n    this.panel_.addControls(this.controls_);\n    map.addPanels(this.panel_);\n  }\n\n  /**\n   * @getter\n   * @public\n   */\n  get name() {\n    return 'edition';\n  }\n\n  /**\n   * This function gets metadata plugin\n   *\n   * @public\n   * @getter\n   * @api stable\n   * @return {Object}\n   */\n  getMetadata() {\n    return this.metadata_;\n  }\n\n  /**\n   * Get the API REST Parameters of the plugin\n   *\n   * @function\n   * @public\n   * @api\n   */\n  getAPIRest() {\n    return `${this.name}=${this.position}`;\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.control_.destroyControls();\n    this.map_.removeControls([this.control_]);\n    this.map_ = null;\n    this.control_ = null;\n    this.panel_ = null;\n  }\n\n  /**\n   * This function compare if pluging recieved by param is instance of M.plugin.Transparency\n   *\n   * @public\n   * @function\n   * @param {M.plugin} plugin to compare\n   * @api stable\n   */\n  equals(plugin) {\n    if (plugin instanceof Edition) {\n      return true;\n    }\n    return false;\n  }\n}\n","import M$plugin$Edition from '/home/irenevinas/m5/mapea-publico/src/plugins/v5/edition/src/facade/js/edition';\n\nif (!window.M.plugin) window.M.plugin = {};\nwindow.M.plugin.Edition = M$plugin$Edition;\n"],"sourceRoot":""}